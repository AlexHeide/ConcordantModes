(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)




If[job=="initialize",
<<VectorAnalysis`;
<<Combinatorica`;
Off[General::spell1,General::spell]];



If[job=="initialize",
(* 2006 CODATA recommended values *)
cSpeed=299792458;
eCharge=1.602176487*10^-19;
hbar=1.054571628*10^-34;
mElectron=9.10938215*10^-31;
NAvogadro=6.02214179*10^23;
HART=4.35974394;
BOHR=0.52917721092;
DEBYE=cSpeed*eCharge*BOHR*10^11;
wave=Sqrt[10 NAvogadro]/(2 \[Pi] cSpeed);
rad=N[180/\[Pi],12];
conv=1;
ichop={10,7,5,5,5,5};
forcewrite=False;
fctrunc=False;
formula=False;
showprogress=False;
degensets={};
degensym=False;
linearmol=False;
\[Theta]lin={};
\[Theta]linsym={};
geomtol=10^-12;
sumcut=10^-12;
sciexpnull=1000;

{mH,mD,mT,
mHe3,mHe,
mLi6,mLi,mBe,mB10,mB,
mC,mC13,mC14,mN,mN15,mO,mO17,mO18,
mF,mNe,mNe21,mNe22,mNa,
mMg,mMg25,mMg26,mAl,
mSi,mSi29,mSi30,mP,
mS,mS33,mS34,mCl,mS36,mAr36,mCl37,
mAr38,mAr,mK,mK41,mCa,mCa44,mSc,
mTi46,mTi47,mTi,mTi49,mTi50,mV50,mV,
mCr50,mCr,mCr53,mCr54,mMn,
mFe54,mFe,mFe57,mCo,
mNi,mNi60,mNi61,mNi62,mNi64,
mCu,mCu65,mZn,mZn66,mZn67,mZn68,mZn70}=
{1.0078250321,2.0141017780,3.0160492675,
3.0160293097,4.0026032497,
6.015122281,7.016004049,9.012182135,10.012937027,11.009305466,
12.0000000,13.0033548378,14.003241988,14.0030740052,15.0001088984,15.9949146221,16.999131501,17.999160419,18.998403205,19.9924401759,20.99384674,21.99138551,22.989769675,
23.985041898,24.985837023,25.982593040,26.981538441,
27.9769265327,28.976494719,29.973770218,30.973761512,
31.972070690,32.971458497,33.967866831,34.968852707,35.967080880,35.967546282,36.965902600,
37.962732161,39.962383123,38.963706679,40.961825762,39.962590983,43.955481754,44.955911909,
45.952631555,46.951763088,47.947946281,48.947869982,49.944791194,49.947158485,50.943959507,
49.946044205,51.940507472,52.940649386,53.938880395,54.938045141,
53.939610501,55.934937475,56.935393969,58.933195048,
57.935342907,59.930786372,60.931056033,61.928345115,63.927965959,
62.929597474,64.927789485,63.929142222,65.926033419,66.927127345,67.924844154,69.925319274};

Vprod[{x1_,y1_,z1_},{x2_,y2_,z2_}]={-y2 z1+y1 z2,x2 z1-x1 z2,-x2 y1+x1 y2};

Vnorm[{x1_,y1_,z1_}]=Sqrt[x1^2+y1^2+z1^2];

Rab[{x1_,y1_,z1_},{x2_,y2_,z2_}]=Sqrt[(x1-x2)^2+(y1-y2)^2+(z1-z2)^2];

Cos\[Theta]abc[{x1_,y1_,z1_},{x2_,y2_,z2_},{x3_,y3_,z3_}]=((x1-x2) (x3-x2)+(y1-y2) (y3-y2)+(z1-z2) (z3-z2))/(Rab[{x1,y1,z1},{x2,y2,z2}] Rab[{x3,y3,z3},{x2,y2,z2}]);

Tan\[Tau]abcd[{x1_,y1_,z1_},{x2_,y2_,z2_},{x3_,y3_,z3_},{x4_,y4_,z4_}]=
(Rab[{x2,y2,z2},{x3,y3,z3}] Dot[{x1-x2,y1-y2,z1-z2},
Vprod[{x2-x3,y2-y3,z2-z3},{x4-x3,y4-y3,z4-z3}]])/
Dot[Vprod[{x1-x2,y1-y2,z1-z2},{x3-x2,y3-y2,z3-z2}],
Vprod[{x2-x3,y2-y3,z2-z3},{x4-x3,y4-y3,z4-z3}]];

Sgn\[Tau]abcd[{x1_,y1_,z1_},{x2_,y2_,z2_},{x3_,y3_,z3_},{x4_,y4_,z4_}]=
Sign[Dot[{x1-x2,y1-y2,z1-z2},
Vprod[{x2-x3,y2-y3,z2-z3},{x4-x3,y4-y3,z4-z3}]]];

Sin\[Gamma]abcd[{x1_,y1_,z1_},{x2_,y2_,z2_},{x3_,y3_,z3_},{x4_,y4_,z4_}]=Dot[Normalize[{x1-x2,y1-y2,z1-z2}],Normalize[Vprod[{x3-x2,y3-y2,z3-z2},{x4-x2,y4-y2,z4-z2}]]];

Sym\[Gamma]abcd[{x1_,y1_,z1_},{x2_,y2_,z2_},{x3_,y3_,z3_},{x4_,y4_,z4_}]=Dot[Normalize[{x1-x2,y1-y2,z1-z2}],Vprod[Normalize[{x3-x2,y3-y2,z3-z2}],Normalize[{x4-x2,y4-y2,z4-z2}]]];

\[Alpha]xabcd[{x1_,y1_,z1_},{x2_,y2_,z2_},{x3_,y3_,z3_},{x4_,y4_,z4_}]=Dot[Normalize[Vprod[Normalize[{x1-x2,y1-y2,z1-z2}],Normalize[{x3-x2,y3-y2,z3-z2}]]],
Vprod[Normalize[{x4-x3,y4-y3,z4-z3}],Normalize[{x3-x2,y3-y2,z3-z2}]]];

\[Alpha]yabcd[{x1_,y1_,z1_},{x2_,y2_,z2_},{x3_,y3_,z3_},{x4_,y4_,z4_}]=Dot[Normalize[{x1-x2,y1-y2,z1-z2}],
Vprod[Normalize[{x4-x3,y4-y3,z4-z3}],Normalize[{x3-x2,y3-y2,z3-z2}]]]/
Vnorm[Vprod[Normalize[{x1-x2,y1-y2,z1-z2}],Normalize[{x3-x2,y3-y2,z3-z2}]]];

sLINabc[{x1_,y1_,z1_},{x2_,y2_,z2_},{x3_,y3_,z3_},{x4_,y4_,z4_}]:=
Dot[{x4,y4,z4},Vprod[{x3-x2,y3-y2,z3-z2},{x1-x2,y1-y2,z1-z2}]]/(Rab[{x1,y1,z1},{x2,y2,z2}] Rab[{x3,y3,z3},{x2,y2,z2}] Vnorm[{x4,y4,z4}]);


\!\(\*SuperscriptBox["Abs", "\[Prime]",
MultilineFunction->None]\)[x_]=Sign[x] ];




If[job=="Cart",
If[Cartfunc,Cartgeom=Table[(CART@@(re+dispmin[[k]]*rr))/BOHR,{k,Length[dispmin]}],
natoms=Length[xref];nCart=3 natoms;
umat=Table[0,{i,nCart},{j,nCart}];
Do[umat[[3 k-3+j,3 k-3+j]]=1/mass[[k]],{k,Length[mass]},{j,3}];
uxC=Table[3 (FixC[[k,1]]-1)+FixC[[k,2]],{k,Length[FixC]}];
Do[umat[[uxC[[k]],uxC[[k]]]]=0,{k,Length[uxC]}];
Cartgeom=Table[0,{k,Length[dispmin]},{j,natoms}];
xpoint=BOHR Flatten[xref];
Bmat=Transpose[Table[Evaluate[D[INTC@@Table[x[j],{j,nCart}],{x[i],1}]]/.Table[x[j]-> xpoint[[j]],{j,nCart}],{i,nCart}]];
Gmat=Dot[Dot[Bmat,umat],Transpose[Bmat]];
Amat=Transpose[Dot[Dot[Inverse[Gmat],Bmat],umat]];
Do[skx=dispmin[[k]] rr;rkx=skx+re;xiter=xpoint;
sknorm=Sqrt[Dot[skx,skx]];kiter=0;
While[sknorm>geomtol&&kiter<20,kiter=kiter+1;xiter=xiter+Dot[Amat,skx];
skx=rkx-INTC@@xiter;sknorm=Sqrt[Dot[skx,skx]]];
xiter=Chop[xiter,geomtol]/BOHR;
Do[Cartgeom[[k,j]]={xiter[[3 j-2]],xiter[[3 j-1]],xiter[[3 j]]},{j,natoms}],{k,Length[dispmin]}]];

geomcheck=Round[Table[(INTC@@Flatten[Cartgeom[[k]]*BOHR]-re)/rr,{k,Length[dispmin]}]]-dispmin;
checknorm=Sum[Dot[geomcheck[[k]],geomcheck[[k]]],{k,Length[geomcheck]}];
If[checknorm== 0,
SetDirectory[geomDir];
OpenWrite[geomFile];
wx=sciexpnull;
Do[fd=Cartgeom[[k]];WriteString[geomFile,k,"  \n"];Do[WriteString[geomFile,PaddedForm[fd[[j,1]],{20,10},ExponentFunction->(If[-wx<#<wx,Null,#]&)],PaddedForm[fd[[j,2]],{20,10},ExponentFunction->(If[-wx<#<wx,Null,#]&)],PaddedForm[fd[[j,3]],{20,10},ExponentFunction->(If[-wx<#<wx,Null,#]&)],"  \n"],{j,Length[fd]}],{k,Length[Cartgeom]}];
Close[geomFile],Print["Geometry check failed"]]];


If[job=="getsym",
TestSym[Geom_,Op_]:=(
SymPresent = 1;
For[Atom1=1,Atom1 <=Length[Geom],Atom1++,{
SymResult =SymEffects[[Position[SymNames,Op][[1,1]]]] * Geom[[Atom1]] ;
AtomHasSym = 0;
For[Atom2=1,Atom2 <=Length[Geom],Atom2++,{
If[Geom[[Atom2]]==SymResult && mass[[Atom1]]==mass[[Atom2]],AtomHasSym=1];
}];
If[AtomHasSym==0,SymPresent=0];
} ];
Return[SymPresent];
);

If[Length[dispmin]==0,{Print["Empty dispmin - run jobtype=disp first"],Return[]}];
If[Length[Cartgeom]==0,{Print["Empty Cartgeom - run jobtype=Cart first"],Return[]}];
SymNames = {"C2(x)","C2(y)","C2(z)","\[Sigma](xy)","\[Sigma](xz)","\[Sigma](yz)","i"};
SymEffects = {{1,-1,-1},{-1,1,-1},{-1,-1,1},{1,1,-1},{1,-1,1},{-1,1,1},{-1,-1,-1}};
MolSym = {};
Do[If[TestSym[xref,SymNames[[i]]]==1,AppendTo[MolSym,i]],{i,Length[SymNames]}];

SymList = Table[{},{i,Length[MolSym]}];
For[S=1,S<=n,S++,{
PlusVector=Table[0,{i,n}];
PlusVector[[S]]=1;
PlusPos = Position[dispmin,PlusVector][[1,1]];
PlusGeom = Cartgeom[[PlusPos]];
MinusVector=Table[0,{i,n}];
MinusVector[[S]]=-1;
MinusPos = Position[dispmin,MinusVector][[1,1]];
MinusGeom = Cartgeom[[MinusPos]];
For[Op=1,Op<=Length[MolSym],Op++,{
SymOperation = SymEffects[[MolSym[[Op]]]];
AllAtomsMapped = True;
For[PlusAtom=1,PlusAtom<=Length[Cartgeom[[1]]],PlusAtom++,{
ThisAtomMapped = False;
For[MinusAtom=1,MinusAtom<=Length[Cartgeom[[1]]],MinusAtom++,{
If[SymOperation* PlusGeom[[PlusAtom]] == MinusGeom[[MinusAtom]]&&mass[[PlusAtom]]==mass[[MinusAtom]],ThisAtomMapped = True];
If[ThisAtomMapped,Break[]];
}];
If[!ThisAtomMapped,AllAtomsMapped=False];
If[!AllAtomsMapped,Break[]];
}];
If[AllAtomsMapped,AppendTo[SymList[[Op]],S]];
}];
}];

sym={};
Do[If[Length[SymList[[i]]]>0,AppendTo[sym,Union[SymList[[i]]]]],{i,Length[MolSym]}];
Print["Symmetry elements detected, and the coordinates for which S+ and S- are equivalent:"];Print[TableForm[Transpose[Table[{SymNames[[MolSym[[i]]]],SymList[[i]]},{i,Length[MolSym]}]]]];
If[Length[MolSym]==0,Print["No symmetry detected"]];
sym=Sort[sym,#1[[1]]<#2[[1]]&];
Print["The resulting sym array:"];Print[sym];
];



If[job=="trans",
nset=Length[EdataX[[1]]];
EdataS=Table[nc,{k,Length[EdataX]},{j,nset}];
natoms=Length[EdataX[[1,1]]];nCart=3 natoms;

If[nset>= 3,
If[Length[mass]==0,mass=Table[1,{k,natoms}]];
umat=Table[0,{i,nCart},{j,nCart}];
Do[umat[[3 k-3+j,3 k-3+j]]=1/mass[[k]],{k,Length[mass]},{j,3}];
Bsymbolic=Transpose[Table[D[INTC@@Table[x[j],{j,nCart}],{x[i],1}],{i,nCart}]];
Bcompiled=Table[Apply[Compile,{Table[x[j],{j,nCart}],Bsymbolic[[i,k]]}],{i,Length[Bsymbolic]},{k,nCart}]];

Do[xpoint=Flatten[EdataX[[k,1]]] BOHR;
spoint=Chop[INTC@@xpoint,10^-10];
EdataS[[k,1]]=spoint; EdataS[[k,2]]=EdataX[[k,2]];

If[nset>= 3,gpoint=Flatten[EdataX[[k,3]]] (HART/BOHR);
Bmat=Table[Apply[Bcompiled[[i,j]],xpoint],{i,Length[Bcompiled]},{j,nCart}];
Gmat=Dot[Dot[Bmat,umat],Transpose[Bmat]];
gs=Chop[LinearSolve[Gmat,Dot[Bmat,Dot[umat,gpoint]]],10^-10];
EdataS[[k,3]]=gs ],{k,Length[EdataX]}] ];



If[job=="loaddata",
md=dispder+2;
dispe=Table[nc,{k,Length[Edata]}];
kmap=dispe;
Edispmin=Table[nc,{j,Length[Edata[[1,md]]]},{k,Length[dispmin]}];
Do[dispr=(Edata[[k,1]]-re)/rr;
res=Round[dispr]-dispr;
If[Sqrt[Dot[res,res]]<10^-2,dispe[[k]]=Round[dispr]];
dp=Flatten[Position[dispmin,dispe[[k]]]];
If[Length[dp]==1,kmap[[k]]=dp[[1]];
Do[Edispmin[[j,kmap[[k]]]]=Edata[[k,md,j]],{j,Length[Edata[[k,md]]]}]],{k,Length[Edata]}];
If[md==2,Edispmin=Take[Edispmin,{ec}]]];



If[job=="fcout",
wx=sciexpnull;
SetDirectory[fcDir];
fw=fcFile;
OpenWrite[fw];

If[Length[xout]>1,Do[WriteString[fw,PaddedForm[xout[[j,1]],{18,10}],PaddedForm[xout[[j,2]],{18,10}],PaddedForm[xout[[j,3]],{18,10}],"  \n"],{j,Length[xout]}]];

If[Length[mass]>1,
Do[WriteString[fw,PaddedForm[mass[[j]],{10,6}]],{j,Length[mass]}];
WriteString[fw,"  \n"]];

If[forcewrite,fd=fout[[1,1]];
Do[If[fd[[m]]!= 0,WriteString[fw,PaddedForm[m,4],PaddedForm[fd[[m]],{28,8},ExponentFunction->(If[-wx<#<wx,Null,#]&)],"  \n"]],{m,n}];
WriteString[fw,PaddedForm[0,4],"  \n"]];

If[nder>=2,fd=fout[[2,1]];fdn=fout[[2,2]];m=0;
Do[m=m+1;If[fd[[m]]!= 0,If[fctrunc,fdig=fdn[[m]]-MantissaExponent[fd[[m]]][[2]],fdig=6];WriteString[fw,PaddedForm[i,4],PaddedForm[j,4],PaddedForm[fd[[m]],{28,fdig},ExponentFunction->(If[-wx<#<wx,Null,#]&)],"  \n"]],{i,n},{j,i}];WriteString[fw,PaddedForm[0,4],"  \n"]];

If[nder>=3,fd=fout[[3,1]];fdn=fout[[3,2]];m=0;
Do[m=m+1;If[fd[[m]]!= 0,If[fctrunc,fdig=fdn[[m]]-MantissaExponent[fd[[m]]][[2]],fdig=6];WriteString[fw,PaddedForm[i,4],PaddedForm[j,4],PaddedForm[k,4],PaddedForm[fd[[m]],{23,fdig},ExponentFunction->(If[-wx<#<wx,Null,#]&)],"  \n"]],{i,n},{j,i},{k,j}];WriteString[fw,PaddedForm[0,4],"  \n"]];

If[nder>=4,fd=fout[[4,1]];fdn=fout[[4,2]];m=0;
Do[m=m+1;If[fd[[m]]!= 0,If[fctrunc,fdig=fdn[[m]]-MantissaExponent[fd[[m]]][[2]],fdig=6];WriteString[fw,PaddedForm[i,4],PaddedForm[j,4],PaddedForm[k,4],PaddedForm[l,4],PaddedForm[fd[[m]],{18,fdig},ExponentFunction->(If[-wx<#<wx,Null,#]&)],"  \n"]],{i,n},{j,i},{k,j},{l,k}];WriteString[fw,PaddedForm[0,4],"  \n"]];

Clear[xout,fout];
Close[fw]];



If[job=="disp",
tstart=TimeUsed[];
nderx=nder-dispder;
tderx=tder-dispder; 

fdisp[x_]=2 Abs[x]-(1+Sign[x])/2;

nEset=Binomial[n+dispder-1,dispder];
ndermax=6;

Do[
cc=Compositions[t,u];cd={};
Do[If[Count[cc[[q]],0]==0,cd=Join[cd,{cc[[q]]}]],{q,Length[cc]}];
c[t,u]=cd,{t,ndermax+1},{u,t}];

ndx=Floor[(nderx+1)/2];
nbase=Max[n,ndx]+1;
d0=Table[0,{k,n}];
d1=Table[Floor[(k+1)/2] (-1)^(k-1),{k,2 ndx}];
d2=Table[0,{k,ndermax}];

Do[qd[i,j]={},{i,ndermax},{j,i,ndermax}];
qd[2,2]={0};qd[2,4]={1,-1};qd[2,6]={2,0,-2};
qd[3,3]={1,-1};qd[3,5]={2,-2}; qd[3,6]={4,-4};
qd[4,4]={2,0,-2};qd[4,5]={2,-2};qd[4,6]={3,1,-1,-3};
qd[5,5]={3,1,-1,-3};qd[5,6]={1,-1};
qd[6,6]={4,2,0,-2,-4};
Do[
ny=Floor[(nderx-t)/2]+t;xz={};
xx=Flatten[Apply[Table,Join[{Table[{s0[i]},{i,t}]},Table[{s0[i],2 ndx},{i,t}]]],t-1];
Do[xy=ReplacePart[Take[d2,t],d1,Table[{i},{i,t}],xx[[k]]];
t1=Tr[Abs[xy]];t2=Tr[xy];
If[(t1 < ny)  || (Count[qd[t,nderx],t2]==0  && t1==ny),xz=Join[xz,{{t1,xx[[k]]}}]],{k,Length[xx]}];
xz=Sort[xz];xx=Table[xz[[k,2]],{k,Length[xz]}];
pd[t,nderx]=xx;
dd[t,nderx]=Table[ReplacePart[Take[d2,t],d1,Table[{i},{i,t}],xx[[k]]],{k,Length[xx]}],{t,nderx}];

Do[a[t]=Flatten[Apply[Table,Join[{Table[s0[j],{j,t}],{s0[1],n}},Table[{s0[i],s0[i-1]-1},{i,2,t}]]],t-1],{t,tderx}];
disp=Join[{d0},Flatten[Table[ReplacePart[d0,d1,Table[{a[t][[w,i]]},{i,t}],pd[t,nderx][[q]]],{t,tderx},{w,Binomial[n,t]},{q,Length[pd[t,nderx]]}],2]];
npt=Length[disp];

dispcode={0};
Do[kdisp=disp[[k]];
idisp=Complement[Range[n],Flatten[Position[kdisp,0]]];
idispL=Length[idisp];
jdisp=Table[kdisp[[idisp[[j]]]],{j,idispL}];
jdisp=fdisp[jdisp];
jinteger=Sum[Binomial[idisp[[j]]-1,j],{j,idispL,1,-1}]*(2 ndx)^idispL+Dot[Table[(2 ndx)^(j-1),{j,idispL}],jdisp-1]+1+Sum[Binomial[n,j] (2 ndx)^j,{j,idispL-1}];
dispcode=Join[dispcode,{jinteger}],{k,2,npt}];

If[Length[Union[dispcode]]< Length[dispcode],Print["Ambiguous dispcode"]];

If[Length[sym]!=0,

opsublist=Subsets[Range[Length[sym]]];
opsublist=Drop[opsublist,Flatten[Position[opsublist,{}]]];oplisttot={};
Do[oplistk=Flatten[sym[[opsublist[[k]]]]];
oplistm=Union[oplistk];oplistn={};
Do[If[OddQ[Count[oplistk,oplistm[[j]]]],oplistn=Join[oplistn,{oplistm[[j]]}]],{j,Length[oplistm]}];
oplisttot=Join[oplisttot,{oplistn}],{k,Length[opsublist]}];oplisttot=Union[oplisttot];
symtot=Drop[oplisttot,Flatten[Position[oplisttot,{}]]];

dispmap={};
Do[dref=disp[[k]];dset={dref};
Do[
xdset=dref;
Do[xdset[[sym[[s,j]]]]=-xdset[[sym[[s,j]]]],{j,Length[sym[[s]]]}];
dset=Join[dset,{xdset}],{s,Length[sym]}];

dset=Sort[Sort[dset], (Tr[#1]<Tr[#2])& ];

jL=Length[dset];pcode={};
While[(Length[pcode]==0)&&(jL>0),
kdisp=dset[[jL]];
idisp=Complement[Range[n],Flatten[Position[kdisp,0]]];
idispL=Length[idisp];
jdisp=Table[kdisp[[idisp[[j]]]],{j,idispL}];
jdisp=fdisp[jdisp];
jinteger=Sum[Binomial[idisp[[j]]-1,j],{j,idispL,1,-1}]*(2 ndx)^idispL+Dot[Table[(2 ndx)^(j-1),{j,idispL}],jdisp-1]+1+Sum[Binomial[n,j] (2 ndx)^j,{j,idispL-1}];
pcode=Position[dispcode,jinteger];
jL=jL-1];

dk=Flatten[pcode][[1]];
If[dk!= k, dispmap=Join[dispmap,{{k,dk}}]],
{k,2,npt}];

nd=Length[dispmap];
dispmap=Transpose[dispmap];
Clear[disp2];
disp2=Take[disp,dispmap[[1,1]]-1];
Do[disp2=Join[disp2,Take[disp,{dispmap[[1,k]]+1,dispmap[[1,k+1]]-1}]],{k,nd-1}];
disp2=Join[disp2,Take[disp,dispmap[[1,nd]]-npt]],disp2=disp];

sxdisp={};
dispmin=disp2;
If[dispder==0,
Do[dpos=Complement[Range[n],Flatten[Position[disp2[[kdisp]],0]]];
If[Length[dpos]==nderx,
Do[If[OddQ[Length[Intersection[sym[[ksym]],dpos]]],sxdisp=Join[sxdisp,{kdisp}]],
{ksym,Length[sym]}]],{kdisp,Length[disp2]}];
sxdisp=Union[sxdisp];
Do[dispmin=Drop[dispmin,{sxdisp[[k]]}],{k,Length[sxdisp],1,-1}]];

If[(degensym)&&(Length[degensets]!= 0)&&(nder<= 4)&&(dispder<= 2),
SEa=Transpose[degensets][[1]];
SEb=Transpose[degensets][[2]];
Snondegen=Complement[Range[n],Join[SEa,SEb]];

degendisplist={};

If[extrasym,
Do[
Do[degen0=d0;
degen0[[SEb[[k]]]]=j;
degendisplist=Join[degendisplist,{degen0}],{k,Length[SEb]}],{j,Floor[(nderx+1)/2]}];

Do[degen0=d0;
degen0[[SEa[[j]]]]=1;degen0[[SEb[[k]]]]=1;
degendisplist=Join[degendisplist,{degen0}],{k,Length[SEa]},{j,k-1}];

Do[degen0=d0;
degen0[[SEa[[k]]]]=1;degen0[[SEb[[k]]]]=1;
degendisplist=Join[degendisplist,{degen0}],{k,Length[SEa]}];

Do[degen0=d0;
degen0[[SEa[[k]]]]=-1;degen0[[SEb[[j]]]]=1;
degendisplist=Join[degendisplist,{degen0}],{k,Length[SEa]},{j,Length[SEb]}];

Do[degen0=d0;
degen0[[SEb[[k]]]]=-1;degen0[[SEb[[j]]]]=1;
degendisplist=Join[degendisplist,{degen0}];
degen0[[SEb[[k]]]]=1;degen0[[SEb[[j]]]]=1;
degendisplist=Join[degendisplist,{degen0}];
degen0[[SEb[[j]]]]=-1;degen0[[SEb[[k]]]]=1;
degendisplist=Join[degendisplist,{degen0}];
degen0[[SEb[[j]]]]=1;degen0[[SEb[[k]]]]=1;
degendisplist=Join[degendisplist,{degen0}];

degen0[[SEb[[k]]]]=2;degen0[[SEb[[j]]]]=1;
degendisplist=Join[degendisplist,{degen0}];
degen0[[SEb[[k]]]]=1;degen0[[SEb[[j]]]]=2;
degendisplist=Join[degendisplist,{degen0}];
degen0[[SEb[[j]]]]=2;degen0[[SEb[[k]]]]=1;
degendisplist=Join[degendisplist,{degen0}];
degen0[[SEb[[j]]]]=1;degen0[[SEb[[k]]]]=2;
degendisplist=Join[degendisplist,{degen0}],{k,Length[SEb]},{j,k-1}];

];

dispmin00=dispmin;

kdrop={};
Do[
SEadisp=Table[dispmin[[k,SEa[[j]]]],{j,Length[SEa]}];
SEbdisp=Table[dispmin[[k,SEb[[j]]]],{j,Length[SEb]}];
nScoin=Length[SEa]-Count[Table[SEadisp[[j]] SEbdisp[[j]], {j,Length[SEa]}],0];

nSEbnz=Length[SEb]-Count[SEbdisp,0];
nSAnz=Length[Snondegen]-Count[Table[dispmin[[k,Snondegen[[j]]]],{j,Length[Snondegen]}],0];
If[(nSEbnz>2)||(nSEbnz>0 &&nSAnz>0)||nScoin!= 0,kdrop=Join[kdrop,{k}]];

test2a=Table[Abs[dispmin[[k,SEa[[j]]]]],{j,Length[SEa]}];
test2b=Table[Abs[dispmin[[k,SEb[[j]]]]],{j,Length[SEb]}];
test2non=Table[Abs[dispmin[[k,Snondegen[[j]]]]],{j,Length[Snondegen]}];

If[
(MemberQ[test2a,2]&&Count[test2non,0]==Length[Snondegen]&&Count[test2b,0]<Length[test2b])||(MemberQ[test2b,2]&&Count[test2non,0]==Length[Snondegen]&&Count[test2a,0]<Length[test2a]),kdrop=Join[kdrop,{k}]];
If[ (Length[Intersection[{dispmin[[k]]},degendisplist]]> 0),kdrop=Join[kdrop,{k}]],{k,Length[dispmin]}];

kdrop=Sort[Union[kdrop]];
Do[dispmin=Drop[dispmin,{kdrop[[k]]}],{k,Length[kdrop],1,-1}]]
 ];



(* In nv[nder,u,t,m,p], u = displacement order (single, double ...) which contributes
to force constant of order t with composition m; p = contributor combination *)

If[job=="dif",
tsector=0;
tstart=TimeUsed[];

If[linearmol && (Length[\[Theta]lin]> 0),
\[Theta]linsets=Table[degensets[[\[Theta]lin[[j]]]],{j,Length[\[Theta]lin]}]];

findx[0]={{1}};
Do[findx[t]=Flatten[Apply[Table,Join[{Table[s0[j],{j,t}],{s0[1],n}},Table[{s0[i],s0[i-1]},{i,2,t}]]],t-1];
f[t]=Flatten[Apply[Table,Join[{nc,{s0[1],n}},Table[{s0[i],s0[i-1]},{i,2,t}]]],t-1];
If[dispder>0,g[t]=Flatten[Apply[Table,Join[{{},{s0[1],n}},Table[{s0[i],s0[i-1]},{i,2,t}]]],t-1]];
df[t]=f[t],{t,nder}];

If[formula==True, rr=Table[Subscript[\[Delta], k],{k,n}]; epres=Infinity;
nfx=Product[n+k,{k,0,dispder-1}]/Factorial[dispder];
kdx=findx[dispder];
formlabels={"e","g","f","f","f","f","f"};
If[dispder>0,dispvar=Table[Subscript[formlabels[[dispder+1]], kdx[[k]]],{k,nfx}],dispvar={e}];
Edispmin=Table[Apply[dispvar[[j]],dispmin[[k]]],{j,nfx},{k,Length[dispmin]}]];

nv=Table[{0},{ider,ndermax},{u,ider},{t,ider},{m,Length[c[t,u]]},{p,Length[Subsets[Range[u]]]-1}];
n0=Table[{0},{ider,ndermax},{u,ider},{t,ider},{m,Length[c[t,u]]}];

nv[[1, 1, 1, 1, 1]]= {{1, -1}(1/2)};

nv[[2, 1, 1, 1, 1]]= {{1, -1}(1/2)}; 
n0[[2, 1, 2, 1]]= {-2}; nv[[2, 1, 2, 1, 1]]= {{1, 1}}; n0[[2, 2, 2, 1]]= {1}; nv[[2, 2, 2, 1, 1]]= {{-1, -1}(1/2)};nv[[2, 2, 2, 1, 2]]= {{-1, -1}(1/2)};nv[[2, 2, 2, 1, 3]]= {{1, 1}(1/2)};

nv[[3, 1, 1, 1, 1]]= {{8, -8, -1, 1}(1/12)};nv[[3, 1, 3, 1, 1]]= {{-2, 2, 1, -1}(1/2)}; n0[[3, 1, 2, 1]]= {-2,-5/2}; nv[[3, 1, 2, 1, 1]]= {{1, 1, 0, 0},{16,16,-1,-1}/12};  nv[[3, 2, 3, 1, 1]]= {{-1, 1, 0, 0}};nv[[3, 2, 3, 1, 2]]= {{0, 0, 0, 0}};nv[[3, 2, 3, 1, 3]]= {{1, 1, -1, -1}(1/2)};nv[[3, 2, 3, 2, 1]]= {{0, 0, 0, 0}};nv[[3, 2, 3, 2, 2]]= {{-1, 1, 0, 0}};nv[[3, 2, 3, 2, 3]]= {{1, -1, 1, -1}(1/2)}; n0[[3, 2, 2, 1]]= {1,0}; nv[[3, 2, 2, 1, 1]]= {{-1, -1, 0, 0}(1/2),{0,0,0,0}};nv[[3, 2, 2, 1, 2]]= {{-1, -1, 0, 0}(1/2),{0,0,0,0}};nv[[3, 2, 2, 1, 3]]= {{1, 0, 0, 1}(1/2),{1,-1,-1,1}(1/4)};  nv[[3, 3, 3, 1, 1]]= {{1, -1, 0, 0}(1/2)};nv[[3, 3, 3, 1, 2]]= {{1, -1, 0, 0}(1/2)};nv[[3, 3, 3, 1, 3]]= {{1, -1, 0, 0}(1/2)};nv[[3, 3, 3, 1, 4]]= {{-1, 0, 0, 1}(1/2)};nv[[3, 3, 3, 1, 5]]= {{-1, 0, 0, 1}(1/2)};nv[[3, 3, 3, 1, 6]]= {{-1, 0, 0, 1}(1/2)};nv[[3, 3, 3, 1, 7]]= {{1, -1}(1/2)};

nv[[4, 1, 1, 1, 1]]= {{8, -8, -1, 1}(1/12)};nv[[4, 1, 3, 1, 1]]= {{-2, 2, 1, -1}(1/2)}; n0[[4, 1, 2, 1]]= {-5/2};n0[[4, 1, 4, 1]]= {6}; nv[[4, 1, 2, 1, 1]]= {{16, 16, -1, -1}(1/12)};nv[[4, 1, 4, 1, 1]]= {{-4, -4, 1, 1}};  nv[[4, 2, 3, 1, 1]]= {{-1, 1, 0, 0}};nv[[4, 2, 3, 1, 2]]= {{0, 0, 0, 0}};nv[[4, 2, 3, 1, 3]]= {{1, 1, -1, -1, 0, 0, 0, 0}(1/2)};nv[[4, 2, 3, 2, 1]]= {{0, 0, 0, 0}};nv[[4, 2, 3, 2, 2]]= {{-1, 1, 0, 0}};nv[[4, 2, 3, 2, 3]]= {{1, -1, 1, -1, 0, 0, 0, 0}(1/2)}; n0[[4, 2, 2, 1]]= {1};n0[[4, 2, 4, 1]]= {-3};n0[[4, 2, 4, 2]]= {4};n0[[4, 2, 4, 3]]= {-3}; nv[[4, 2, 2, 1, 1]]= {{-7, -7, 1, 1}(1/12)};nv[[4, 2, 2, 1, 2]]= {{-7, -7, 1, 1}(1/12)};nv[[4, 2, 2, 1, 3]]= {{9, -1, -1, 9, -1, -1, -1, -1}(1/12)};nv[[4, 2, 4, 1, 1]]= {{1, 1, 0, 0}(3/2)};nv[[4, 2, 4, 1, 2]]= {{4, 4, -1, -1}(1/2)};nv[[4, 2, 4, 1, 3]]= {{-3, -1, -1, -3, 1, 1, 0, 0}(1/2)};nv[[4, 2, 4, 2, 1]]= {{-1, -1, 0, 0}(2)};nv[[4, 2, 4, 2, 2]]= {{-1, -1, 0, 0}(2)};nv[[4, 2, 4, 2, 3]]= {{1, 1, 1, 1, 0, 0, 0, 0}};nv[[4, 2, 4, 3, 1]]= {{4, 4, -1, -1}(1/2)};nv[[4, 2, 4, 3, 2]]= {{1, 1, 0, 0}(3/2)};nv[[4, 2, 4, 3, 3]]= {{-3, -1, -1, -3, 0, 0, 1, 1}(1/2)};  nv[[4, 3, 3, 1, 1]]= {{1, -1, 0, 0}(1/2)};nv[[4, 3, 3, 1, 2]]= {{1, -1, 0, 0}(1/2)};nv[[4, 3, 3, 1, 3]]= {{1, -1, 0, 0}(1/2)};nv[[4, 3, 3, 1, 4]]= {{-1, 0, 0, 1, 0, 0, 0, 0}(1/2)};nv[[4, 3, 3, 1, 5]]= {{-1, 0, 0, 1, 0, 0, 0, 0}(1/2)};nv[[4, 3, 3, 1, 6]]= {{-1, 0, 0, 1, 0, 0, 0, 0}(1/2)};nv[[4, 3, 3, 1, 7]]= {{1, 0, 0, 0, 0, 0, 0, -1}(1/2)}; 

n0[[4, 3, 4, 1]]= {2,-2};n0[[4, 3, 4, 2]]= {2,-2};n0[[4, 3, 4, 3]]= {2,-2}; nv[[4, 3, 4, 1, 1]]= {{-1, -1, 0, 0}};nv[[4, 3, 4, 1, 2]]= {{-1, -1, 0, 0},{1,1,0,0}};nv[[4, 3, 4, 1, 3]]= {{-1, -1, 0, 0}};nv[[4, 3, 4, 1, 4]]= {{0, 1, 1, 0, 0, 0, 0, 0}};nv[[4, 3, 4, 1, 5]]= {{1, 1, 1, 1, 0, 0, 0, 0}(1/2)};nv[[4, 3, 4, 1, 6]]= {{1, 1, 1, 1, 0, 0, 0, 0}(1/2)};nv[[4, 3, 4, 1, 7]]= {{0, 0, -1, -1, -1, -1, 0, 0}(1/2)};nv[[4, 3, 4, 2, 1]]= {{-1, -1, 0, 0}};nv[[4, 3, 4, 2, 2]]= {{-1, -1, 0, 0}};nv[[4, 3, 4, 2, 3]]= {{-1, -1, 0, 0}};nv[[4, 3, 4, 2, 4]]= {{1, 1, 1, 1, 0, 0, 0, 0}(1/2)};nv[[4, 3, 4, 2, 5]]= {{0, 1, 1, 0, 0, 0, 0, 0}};nv[[4, 3, 4, 2, 6]]= {{1, 1, 1, 1, 0, 0, 0, 0}(1/2)};nv[[4, 3, 4, 2, 7]]= {{0, -1, 0, -1, -1, 0, -1, 0}(1/2)};nv[[4, 3, 4, 3, 1]]= {{-1, -1, 0, 0}};nv[[4, 3, 4, 3, 2]]= {{-1, -1, 0, 0}};nv[[4, 3, 4, 3, 3]]= {{-1, -1, 0, 0}};nv[[4, 3, 4, 3, 4]]= {{1, 1, 1, 1, 0, 0, 0, 0}(1/2)};nv[[4, 3, 4, 3, 5]]= {{1, 1, 1, 1, 0, 0, 0, 0}(1/2)};nv[[4, 3, 4, 3, 6]]= {{0, 1, 1, 0, 0, 0, 0, 0}};nv[[4, 3, 4, 3, 7]]= {{0, -1, -1, 0, 0, -1, -1, 0}(1/2)}; n0[[4, 4, 4, 1]]= {-15}; 

av[1]={1, 1, 0, 0}(11/2);
av[2]={-3, -4, -4, -3, 0, 0, 0, 0}(1/2);
av[3]={0, 1, 1, 1, 1, 1, 1, 0}(1/2);
nv[[4, 4, 4, 1, 1]]= {av[1]};nv[[4, 4, 4, 1, 2]]={av[1]};nv[[4, 4, 4, 1, 3]]= {av[1]};nv[[4, 4, 4, 1, 4]]= {av[1]};nv[[4, 4, 4, 1, 5]]= {av[2]};nv[[4, 4, 4, 1, 6]]= {av[2]};nv[[4, 4, 4, 1, 7]]= {av[2]};nv[[4, 4, 4, 1, 8]]= {av[2]};nv[[4, 4, 4, 1, 9]]= {av[2]};nv[[4, 4, 4, 1, 10]]= {av[2]};nv[[4, 4, 4, 1, 11]]= {av[3]};nv[[4, 4, 4, 1, 12]]= {av[3]};nv[[4, 4, 4, 1, 13]]= {av[3]};nv[[4, 4, 4, 1, 14]]={av[3]};
nv[[4, 4, 4, 1, 15]]= {{1, 1}(1/2)};

nv[[5, 1, 1, 1, 1]]= {{45, -45, -9, 9, 1, -1}(1/60)};nv[[5, 1, 3, 1, 1]]= {{-13, 13, 8, -8, -1, 1}(1/8)};nv[[5, 1, 5, 1, 1]]= {{5, -5, -4, 4, 1, -1}(1/2)};
n0[[5, 1, 2, 1]]= {-5/2,-49/18};
n0[[5, 1, 4, 1]]= {6,28/3}; nv[[5, 1, 2, 1, 1]]= {{16, 16, -1, -1, 0, 0}(1/12),{270,270,-27,-27,2,2}/180};nv[[5, 1, 4, 1, 1]]= {{-4, -4, 1, 1, 0, 0},{-39,-39,12,12,-1,-1}/6};  nv[[5, 2, 3, 1, 1]]= {{-19, 19, 2, -2, 0, 0}(1/12)};nv[[5, 2, 3, 1, 2]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 2, 3, 1, 3]]= {{20, 20, -20, -20, -1, -1, 1, 1, -2, -2, 2, 2}(1/24)};nv[[5, 2, 3, 2, 1]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 2, 3, 2, 2]]= {{-19, 19, 2, -2, 0, 0}(1/12)};nv[[5, 2, 3, 2, 3]]= {{20, -20, 20, -20, -2, 2, -2, 2, -1, 1, -1, 1}(1/24)};nv[[5, 2, 5, 1, 1]]= {{1, -1, 0, 0, 0, 0}(3)};nv[[5, 2, 5, 1, 2]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 2, 5, 1, 3]]= {{-4, -4, 4, 4, 1, 1, -1, -1, 0, 0, 0, 0}(1/2)};nv[[5, 2, 5, 2, 1]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 2, 5, 2, 2]]= {{2, -2, -1, 1, 0, 0}};nv[[5, 2, 5, 2, 3]]= {{-2, 2, -2, 2, 1, -1, 1, -1, 0, 0, 0, 0}(1/2)};nv[[5, 2, 5, 3, 1]]= {{2, -2, -1, 1, 0, 0}};nv[[5, 2, 5, 3, 2]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 2, 5, 3, 3]]= {{-2, -2, 2, 2, 0, 0, 0, 0, 1, 1, -1, -1}(1/2)};nv[[5, 2, 5, 4, 1]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 2, 5, 4, 2]]= {{1, -1, 0, 0, 0, 0}(3)};nv[[5, 2, 5, 4, 3]]= {{-4, 4, -4, 4, 0, 0, 0, 0, 1, -1, 1, -1}(1/2)}; n0[[5, 2, 2, 1]]= {1};n0[[5, 2, 4, 1]]= {-3};n0[[5, 2, 4, 2]]= {4};n0[[5, 2, 4, 3]]= {-3}; nv[[5, 2, 2, 1, 1]]= {{-7, -7, 1, 1, 0, 0}(1/12)};nv[[5, 2, 2, 1, 2]]= {{-7, -7, 1, 1, 0, 0}(1/12)};nv[[5, 2, 2, 1, 3]]= {{9, -1, -1, 9, -1, 0, 0, -1, -1, 0, 0, -1}(1/12)};nv[[5, 2, 4, 1, 1]]= {{1, 1, 0, 0, 0, 0}(3/2)};nv[[5, 2, 4, 1, 2]]= {{4, 4, -1, -1, 0, 0}(1/2)};nv[[5, 2, 4, 1, 3]]= {{-3, -1, -1, -3, 1, 0, 0, 1, 0, 0, 0, 0}(1/2)};nv[[5, 2, 4, 2, 1]]= {{-1, -1, 0, 0, 0, 0}(2)};nv[[5, 2, 4, 2, 2]]= {{-1, -1, 0, 0, 0, 0}(2)};nv[[5, 2, 4, 2, 3]]= {{1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[5, 2, 4, 3, 1]]= {{4, 4, -1, -1, 0, 0}(1/2)};nv[[5, 2, 4, 3, 2]]= {{1, 1, 0, 0, 0, 0}(3/2)};nv[[5, 2, 4, 3, 3]]= {{-3, -1, -1, -3, 0, 0, 0, 0, 1, 0, 0, 1}(1/2)};  nv[[5, 3, 3, 1, 1]]= {{19, -19, -2, 2, 0, 0}(1/24)};nv[[5, 3, 3, 1, 2]]= {{19, -19, -2, 2, 0, 0}(1/24)};nv[[5, 3, 3, 1, 3]]= {{19, -19, -2, 2, 0, 0}(1/24)};nv[[5, 3, 3, 1, 4]]= {{-86, 0, 0, 86, 9, 1, -1, -9, 9, -1, 1, -9}(1/96)};nv[[5, 3, 3, 1, 5]]= {{-86, 0, 0, 86, 9, 1, -1, -9, 9, -1, 1, -9}(1/96)};nv[[5, 3, 3, 1, 6]]= {{-86, 0, 0, 86, 9, 1, -1, -9, 9, -1, 1, -9}(1/96)};nv[[5, 3, 3, 1, 7]]= {{96, 0, 0, 0, 0, 0, 0, -96, -9, -1, -9, -1, 1, 9, 1, 9, -9, 1, -1, 9}(1/96)};nv[[5, 3, 5, 1, 1]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 3, 5, 1, 2]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 3, 5, 1, 3]]= {{-2, 2, 1, -1, 0, 0}(1/2)};nv[[5, 3, 5, 1, 4]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 3, 5, 1, 5]]= {{8, 0, 0, -8, -3, 1, -1, 3, 0, 0, 0, 0}(1/8)};nv[[5, 3, 5, 1, 6]]= {{8, 0, 0, -8, -3, 1, -1, 3, 0, 0, 0, 0}(1/8)};nv[[5, 3, 5, 1, 7]]= {{-8, 0, 0, 0, 0, 0, 0, 8, 3, -1, 0, 0, 1, -3, 0, 0, 0, 0, 0, 0}(1/8)};nv[[5, 3, 5, 2, 1]]= {{1, -1, 0, 0, 0, 0}(1/2)};nv[[5, 3, 5, 2, 2]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 3, 5, 2, 3]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 3, 5, 2, 4]]= {{-2, 0, 0, 2, -1, -1, 1, 1, 1, -1, 1, -1}(1/8)};nv[[5, 3, 5, 2, 5]]= {{-2, 0, 0, 2, -1, -1, 1, 1, 1, -1, 1, -1}(1/8)};nv[[5, 3, 5, 2, 6]]= {{2, 0, 0, -2, -1, -1, 1, 1, -1, 1, -1, 1}(1/8)};nv[[5, 3, 5, 2, 7]]= {{0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, -1, -1, -1, -1, -1, 1, -1, 1}(1/8)};nv[[5, 3, 5, 3, 1]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 3, 5, 3, 2]]= {{-2, 2, 1, -1, 0, 0}(1/2)};nv[[5, 3, 5, 3, 3]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 3, 5, 3, 4]]= {{8, 0, 0, -8, -3, 1, -1, 3, 0, 0, 0, 0}(1/8)};nv[[5, 3, 5, 3, 5]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 3, 5, 3, 6]]= {{8, 0, 0, -8, 0, 0, 0, 0, -3, -1, 1, 3}(1/8)};nv[[5, 3, 5, 3, 7]]= {{-8, 0, 0, 0, 0, 0, 0, 8, 0, 0, 3, -1, 0, 0, 1, -3, 0, 0, 0, 0}(1/8)};nv[[5, 3, 5, 4, 1]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 3, 5, 4, 2]]= {{1, -1, 0, 0, 0, 0}(1/2)};nv[[5, 3, 5, 4, 3]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 3, 5, 4, 4]]= {{-2, 0, 0, 2, 1, 1, -1, -1, -1, 1, -1, 1}(1/8)};nv[[5, 3, 5, 4, 5]]= {{2, 0, 0, -2, -1, -1, 1, 1, -1, 1, -1, 1}(1/8)};nv[[5, 3, 5, 4, 6]]= {{-2, 0, 0, 2, -1, -1, 1, 1, 1, -1, 1, -1}(1/8)};nv[[5, 3, 5, 4, 7]]= {{0, 0, 0, 0, 0, 0, 0, 0, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, 1, -1}(1/8)};nv[[5, 3, 5, 5, 1]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 3, 5, 5, 2]]= {{0, 0, 0, 0, 0, 0}};nv[[5, 3, 5, 5, 3]]= {{1, -1, 0, 0, 0, 0}(1/2)};nv[[5, 3, 5, 5, 4]]= {{2, 0, 0, -2, -1, -1, 1, 1, -1, 1, -1, 1}(1/8)};nv[[5, 3, 5, 5, 5]]= {{-2, 0, 0, 2, 1, 1, -1, -1, -1, 1, -1, 1}(1/8)};nv[[5, 3, 5, 5, 6]]= {{-2, 0, 0, 2, 1, 1, -1, -1, -1, 1, -1, 1}(1/8)};nv[[5, 3, 5, 5, 7]]= {{0, 0, 0, 0, 0, 0, 0, 0, -1, -1, 1, 1, 1, 1, -1, -1, 1, -1, 1, -1}(1/8)};nv[[5, 3, 5, 6, 1]]= {{-2, 2, 1, -1, 0, 0}(1/2)};nv[[5, 3, 5, 6, 2]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 3, 5, 6, 3]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 3, 5, 6, 4]]= {{8, 0, 0, -8, 0, 0, 0, 0, -3, -1, 1, 3}(1/8)};nv[[5, 3, 5, 6, 5]]= {{8, 0, 0, -8, 0, 0, 0, 0, -3, -1, 1, 3}(1/8)};nv[[5, 3, 5, 6, 6]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 3, 5, 6, 7]]= {{-8, 0, 0, 0, 0, 0, 0, 8, 0, 0, 0, 0, 0, 0, 0, 0, 3, 1, -1, -3}(1/8)}; 

n0[[5, 3, 4, 1]]= {2};n0[[5, 3, 4, 2]]= {2};n0[[5, 3, 4, 3]]= {2}; nv[[5, 3, 4, 1, 1]]= {{-1, -1, 0, 0, 0, 0}};nv[[5, 3, 4, 1, 2]]= {{-1, -1, 0, 0, 0, 0}};nv[[5, 3, 4, 1, 3]]= {{-1, -1, 0, 0, 0, 0}};nv[[5, 3, 4, 1, 4]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[5, 3, 4, 1, 5]]= {{1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[5, 3, 4, 1, 6]]= {{1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[5, 3, 4, 1, 7]]= {{0, 0, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[5, 3, 4, 2, 1]]= {{-1, -1, 0, 0, 0, 0}};nv[[5, 3, 4, 2, 2]]= {{-1, -1, 0, 0, 0, 0}};nv[[5, 3, 4, 2, 3]]= {{-1, -1, 0, 0, 0, 0}};nv[[5, 3, 4, 2, 4]]= {{1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[5, 3, 4, 2, 5]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[5, 3, 4, 2, 6]]= {{1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[5, 3, 4, 2, 7]]= {{0, -1, 0, -1, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[5, 3, 4, 3, 1]]= {{-1, -1, 0, 0, 0, 0}};nv[[5, 3, 4, 3, 2]]= {{-1, -1, 0, 0, 0, 0}};nv[[5, 3, 4, 3, 3]]= {{-1, -1, 0, 0, 0, 0}};nv[[5, 3, 4, 3, 4]]= {{1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[5, 3, 4, 3, 5]]= {{1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[5, 3, 4, 3, 6]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[5, 3, 4, 3, 7]]= {{0, -1, -1, 0, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};

nv[[5, 4, 5, 1, 1]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 1, 2]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 1, 3]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 1, 4]]= {{1, -1, 0, 0, 0, 0}(5/4)};nv[[5, 4, 5, 1, 5]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 1, 6]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 1, 7]]= {{-2, 4, -4, 2, -1, -1, 1, 1, 1, -1, 1, -1}(1/8)};nv[[5, 4, 5, 1, 8]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 1, 9]]= {{-2, 4, -4, 2, -1, -1, 1, 1, 1, -1, 1, -1}(1/8)};nv[[5, 4, 5, 1, 10]]= {{-2, 4, -4, 2, -1, -1, 1, 1, 1, -1, 1, -1}(1/8)};nv[[5, 4, 5, 1, 11]]= {{-16, 0, 0, 0, 0, 0, 0, 16, 1, 1, 1, 1, -1, -1, -1, -1, 1, -1, 1, -1}(1/16)};nv[[5, 4, 5, 1, 12]]= {{0, 0, 0, 0, 0, 0, 0, 0, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, -1, 1}(1/16)};nv[[5, 4, 5, 1, 13]]= {{0, 0, 0, 0, 0, 0, 0, 0, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, -1, 1}(1/16)};nv[[5, 4, 5, 1, 14]]= {{0, 0, 0, 0, 0, 0, 0, 0, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, -1, 1}(1/16)};nv[[5, 4, 5, 1, 15]]= {{1, -1, -1, 1, -1, 1, 1, -1}(1/4)};nv[[5, 4, 5, 2, 1]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 2, 2]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 2, 3]]= {{1, -1, 0, 0, 0, 0}(5/4)};nv[[5, 4, 5, 2, 4]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 2, 5]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 2, 6]]= {{-2, 4, -4, 2, -1, -1, 1, 1, 1, -1, 1, -1}(1/8)};nv[[5, 4, 5, 2, 7]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 2, 8]]= {{-2, 4, -4, 2, -1, -1, 1, 1, 1, -1, 1, -1}(1/8)};nv[[5, 4, 5, 2, 9]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 2, 10]]= {{-2, -4, 4, 2, 1, 1, -1, -1, -1, 1, -1, 1}(1/8)};nv[[5, 4, 5, 2, 11]]= {{0, 0, 0, 0, 0, 0, 0, 0, 1, 1, -1, -1, -1, -1, 1, 1, -1, 1, -1, 1}(1/16)};nv[[5, 4, 5, 2, 12]]= {{-16, 0, 0, 0, 0, 0, 0, 16, 1, 1, 1, 1, -1, -1, -1, -1, 1, -1, 1, -1}(1/16)};nv[[5, 4, 5, 2, 13]]= {{0, 0, 0, 0, 0, 0, 0, 0, -1, -1, 1, 1, 1, 1, -1, -1, -1, 1, -1, 1}(1/16)};nv[[5, 4, 5, 2, 14]]= {{0, 0, 0, 0, 0, 0, 0, 0, -1, -1, 1, 1, 1, 1, -1, -1, -1, 1, -1, 1}(1/16)};nv[[5, 4, 5, 2, 15]]= {{1, -1, 1, -1, 1, -1, 1, -1}(1/4)};nv[[5, 4, 5, 3, 1]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 3, 2]]= {{1, -1, 0, 0, 0, 0}(5/4)};nv[[5, 4, 5, 3, 3]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 3, 4]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 3, 5]]= {{-2, 4, -4, 2, -1, -1, 1, 1, 1, -1, 1, -1}(1/8)};nv[[5, 4, 5, 3, 6]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 3, 7]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 3, 8]]= {{-2, -4, 4, 2, 1, 1, -1, -1, -1, 1, -1, 1}(1/8)};nv[[5, 4, 5, 3, 9]]= {{-2, -4, 4, 2, 1, 1, -1, -1, -1, 1, -1, 1}(1/8)};nv[[5, 4, 5, 3, 10]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 3, 11]]= {{0, 0, 0, 0, 0, 0, 0, 0, -1, -1, 1, 1, 1, 1, -1, -1, -1, 1, -1, 1}(1/16)};nv[[5, 4, 5, 3, 12]]= {{0, 0, 0, 0, 0, 0, 0, 0, -1, -1, 1, 1, 1, 1, -1, -1, -1, 1, -1, 1}(1/16)};nv[[5, 4, 5, 3, 13]]= {{-16, 0, 0, 0, 0, 0, 0, 16, 1, 1, 1, 1, -1, -1, -1, -1, 1, -1, 1, -1}(1/16)};nv[[5, 4, 5, 3, 14]]= {{0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, 1, 1, 1, 1, 1, -1, 1, -1}(1/16)};nv[[5, 4, 5, 3, 15]]= {{1, 1, -1, -1, 1, 1, -1, -1}(1/4)};nv[[5, 4, 5, 4, 1]]= {{1, -1, 0, 0, 0, 0}(5/4)};nv[[5, 4, 5, 4, 2]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 4, 3]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 4, 4]]= {{-1, 1, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 4, 5]]= {{-2, -4, 4, 2, 1, 1, -1, -1, -1, 1, -1, 1}(1/8)};nv[[5, 4, 5, 4, 6]]= {{-2, -4, 4, 2, 1, 1, -1, -1, -1, 1, -1, 1}(1/8)};nv[[5, 4, 5, 4, 7]]= {{-2, -4, 4, 2, 1, 1, -1, -1, -1, 1, -1, 1}(1/8)};nv[[5, 4, 5, 4, 8]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 4, 9]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 4, 10]]= {{1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0}(3/4)};nv[[5, 4, 5, 4, 11]]= {{0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, 1, 1, 1, 1, 1, -1, 1, -1}(1/16)};nv[[5, 4, 5, 4, 12]]= {{0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, 1, 1, 1, 1, 1, -1, 1, -1}(1/16)};nv[[5, 4, 5, 4, 13]]= {{0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, 1, 1, 1, 1, 1, -1, 1, -1}(1/16)};nv[[5, 4, 5, 4, 14]]= {{-16, 0, 0, 0, 0, 0, 0, 16, 1, 1, 1, 1, -1, -1, -1, -1, 1, -1, 1, -1}(1/16)};nv[[5, 4, 5, 4, 15]]= {{1, 1, 1, 1, -1, -1, -1, -1}(1/4)}; 

av[1]={1, 1, 0, 0, 0, 0}(11/2);
av[2]={-3, -4, -4, -3, 0, 0, 0, 0, 0, 0, 0, 0}(1/2);
av[3]={0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2);
n0[[5, 4, 4, 1]]= {-15};
nv[[5, 4, 4, 1, 1]]= {av[1]};nv[[5, 4, 4, 1, 2]]= {av[1]};nv[[5, 4, 4, 1, 3]]= {av[1]};nv[[5, 4, 4, 1, 4]]= {av[1]};nv[[5, 4, 4, 1, 5]]= {av[2]};nv[[5, 4, 4, 1, 6]]={av[2]};nv[[5, 4, 4, 1, 7]]= {av[2]};nv[[5, 4, 4, 1, 8]]= {av[2]};nv[[5, 4, 4, 1, 9]]= {av[2]};nv[[5, 4, 4, 1, 10]]= {av[2]};nv[[5, 4, 4, 1, 11]]= {av[3]};nv[[5, 4, 4, 1, 12]]= {av[3]};nv[[5, 4, 4, 1, 13]]= {av[3]};nv[[5, 4, 4, 1, 14]]= {av[3]};nv[[5, 4, 4, 1, 15]]= {{1, 0, 0, 0, 0, 0, 0, 1}(1/2)};  

av[1]={1, -1, 0, 0, 0, 0}(1/2);
av[2]={-1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0}(1/2);
av[3]={1, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2);
av[4]={-1, 0, 0, 0, 0, 0, 0, 1}(1/2);
nv[[5, 5, 5, 1, 1]]= {av[1]};nv[[5, 5, 5, 1, 2]]= {av[1]};nv[[5, 5, 5, 1, 3]]= {av[1]};nv[[5, 5, 5, 1, 4]]={av[1]};nv[[5, 5, 5, 1, 5]]= {av[1]};nv[[5, 5, 5, 1, 6]]= {av[2]};nv[[5, 5, 5, 1, 7]]={av[2]};nv[[5, 5, 5, 1, 8]]= {av[2]};nv[[5, 5, 5, 1, 9]]= {av[2]};nv[[5, 5, 5, 1, 10]]={av[2]};nv[[5, 5, 5, 1, 11]]= {av[2]};nv[[5, 5, 5, 1, 12]]= {av[2]};nv[[5, 5, 5, 1, 13]]= {av[2]};nv[[5, 5, 5, 1, 14]]= {av[2]};nv[[5, 5, 5, 1, 15]]= {av[2]};nv[[5, 5, 5, 1, 16]]= {av[3]};nv[[5, 5, 5, 1, 17]]= {av[3]};nv[[5, 5, 5, 1, 18]]= {av[3]};nv[[5, 5, 5, 1, 19]]= {av[3]};nv[[5, 5, 5, 1, 20]]= {av[3]};nv[[5, 5, 5, 1, 21]]= {av[3]};nv[[5, 5, 5, 1, 22]]= {av[3]};nv[[5, 5, 5, 1, 23]]= {av[3]};nv[[5, 5, 5, 1, 24]]= {av[3]};nv[[5, 5, 5, 1, 25]]= {av[3]};nv[[5, 5, 5, 1, 26]]= {av[4]};nv[[5, 5, 5, 1, 27]]= {av[4]};nv[[5, 5, 5, 1, 28]]= {av[4]};nv[[5, 5, 5, 1, 29]]= {av[4]};nv[[5, 5, 5, 1, 30]]={av[4]};nv[[5, 5, 5, 1, 31]]= {{1, -1}(1/2)};

nv[[6, 1, 1, 1, 1]]= {{45, -45, -9, 9, 1, -1}(1/60)};nv[[6, 1, 3, 1, 1]]= {{-13, 13, 8, -8, -1, 1}(1/8)};nv[[6, 1, 5, 1, 1]]= {{5, -5, -4, 4, 1, -1}(1/2)}; n0[[6, 1, 2, 1]]= {-49/18};n0[[6, 1, 4, 1]]= {28/3};n0[[6, 1, 6, 1]]= {-20}; nv[[6, 1, 2, 1, 1]]= {{270, 270, -27, -27, 2, 2}(1/180)};nv[[6, 1, 4, 1, 1]]= {{-39, -39, 12, 12, -1, -1}(1/6)};nv[[6, 1, 6, 1, 1]]= {{15, 15, -6, -6, 1, 1}};  nv[[6, 2, 3, 1, 1]]= {{-19, 19, 2, -2, 0, 0}(1/12)};nv[[6, 2, 3, 1, 2]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 2, 3, 1, 3]]= {{20, 20, -20, -20, -1, -1, 1, 1, -2, -2, 2, 2, 0, 0, 0, 0, 0, 0}(1/24)};nv[[6, 2, 3, 2, 1]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 2, 3, 2, 2]]= {{-19, 19, 2, -2, 0, 0}(1/12)};nv[[6, 2, 3, 2, 3]]= {{20, -20, 20, -20, -2, 2, -2, 2, -1, 1, -1, 1, 0, 0, 0, 0, 0, 0}(1/24)};nv[[6, 2, 5, 1, 1]]= {{1, -1, 0, 0, 0, 0}(3)};nv[[6, 2, 5, 1, 2]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 2, 5, 1, 3]]= {{-4, -4, 4, 4, 1, 1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 2, 5, 2, 1]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 2, 5, 2, 2]]= {{2, -2, -1, 1, 0, 0}};nv[[6, 2, 5, 2, 3]]= {{-2, 2, -2, 2, 1, -1, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 2, 5, 3, 1]]= {{2, -2, -1, 1, 0, 0}};nv[[6, 2, 5, 3, 2]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 2, 5, 3, 3]]= {{-2, -2, 2, 2, 0, 0, 0, 0, 1, 1, -1, -1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 2, 5, 4, 1]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 2, 5, 4, 2]]= {{1, -1, 0, 0, 0, 0}(3)};nv[[6, 2, 5, 4, 3]]= {{-4, 4, -4, 4, 0, 0, 0, 0, 1, -1, 1, -1, 0, 0, 0, 0, 0, 0}(1/2)}; n0[[6, 2, 2, 1]]= {11/12};n0[[6, 2, 4, 1]]= {-4};n0[[6, 2, 4, 2]]= {6};n0[[6, 2, 4, 3]]= {-4};n0[[6, 2, 6, 1]]= {10};n0[[6, 2, 6, 2]]= {-12};n0[[6, 2, 6, 3]]= {9};n0[[6, 2, 6, 4]]= {-12};n0[[6, 2, 6, 5]]= {10}; nv[[6, 2, 2, 1, 1]]= {{-70, -70, 17, 17, -2, -2}(1/120)};nv[[6, 2, 2, 1, 2]]= {{-70, -70, 17, 17, -2, -2}(1/120)};nv[[6, 2, 2, 1, 3]]= {{320, -60, -60, 320, -60, 4, 4, -60, -60, 4, 4, -60, 6, 6, 5, 5, 6, 6}(1/360)};nv[[6, 2, 4, 1, 1]]= {{9, 9, -1, -1, 0, 0}(1/4)};nv[[6, 2, 4, 1, 2]]= {{23, 23, -8, -8, 1, 1}(1/8)};nv[[6, 2, 4, 1, 3]]= {{-62, -15, -15, -62, 27, -1, -1, 27, 6, 2, 2, 6, -3, -3, -2, -2, 0, 0}(1/24)};nv[[6, 2, 4, 2, 1]]= {{-19, -19, 1, 1, 0, 0}(1/6)};nv[[6, 2, 4, 2, 2]]= {{-19, -19, 1, 1, 0, 0}(1/6)};nv[[6, 2, 4, 2, 3]]= {{20, 20, 20, 20, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0}(1/12)};nv[[6, 2, 4, 3, 1]]= {{23, 23, -8, -8, 1, 1}(1/8)};nv[[6, 2, 4, 3, 2]]= {{9, 9, -1, -1, 0, 0}(1/4)};nv[[6, 2, 4, 3, 3]]= {{-62, -15, -15, -62, 6, 2, 2, 6, 27, -1, -1, 27, 0, 0, -2, -2, -3, -3}(1/24)};nv[[6, 2, 6, 1, 1]]= {{-1, -1, 0, 0, 0, 0}(5)};nv[[6, 2, 6, 1, 2]]= {{-15, -15, 6, 6, -1, -1}(1/2)};nv[[6, 2, 6, 1, 3]]= {{10, 5, 5, 10, -5, -1, -1, -5, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0}(1/2)};nv[[6, 2, 6, 2, 1]]= {{1, 1, 0, 0, 0, 0}(6)};nv[[6, 2, 6, 2, 2]]= {{4, 4, -1, -1, 0, 0}(2)};nv[[6, 2, 6, 2, 3]]= {{-4, -4, -4, -4, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 2, 6, 3, 1]]= {{-4, -4, 1, 1, 0, 0}(3/2)};nv[[6, 2, 6, 3, 2]]= {{-4, -4, 1, 1, 0, 0}(3/2)};nv[[6, 2, 6, 3, 3]]= {{10, 6, 6, 10, -3, -1, -1, -3, -3, -1, -1, -3, 0, 0, 1, 1, 0, 0}(1/2)};nv[[6, 2, 6, 4, 1]]= {{4, 4, -1, -1, 0, 0}(2)};nv[[6, 2, 6, 4, 2]]= {{1, 1, 0, 0, 0, 0}(6)};nv[[6, 2, 6, 4, 3]]= {{-4, -4, -4, -4, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0}};nv[[6, 2, 6, 5, 1]]= {{-15, -15, 6, 6, -1, -1}(1/2)};nv[[6, 2, 6, 5, 2]]= {{-1, -1, 0, 0, 0, 0}(5)};nv[[6, 2, 6, 5, 3]]= {{10, 5, 5, 10, 0, 0, 0, 0, -5, -1, -1, -5, 0, 0, 0, 0, 1, 1}(1/2)};  nv[[6, 3, 3, 1, 1]]= {{-4, 4, -1, 1, 0, 0}(1/12)};nv[[6, 3, 3, 1, 2]]= {{-4, 4, -1, 1, 0, 0}(1/12)};nv[[6, 3, 3, 1, 3]]= {{-4, 4, -1, 1, 0, 0}(1/12)};nv[[6, 3, 3, 1, 4]]= {{5, 0, 0, -5, 0, -1, 1, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0}(1/12)};nv[[6, 3, 3, 1, 5]]= {{5, 0, 0, -5, 0, -1, 1, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0}(1/12)};nv[[6, 3, 3, 1, 6]]= {{5, 0, 0, -5, 0, -1, 1, 0, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0}(1/12)};nv[[6, 3, 3, 1, 7]]= {{-3, -9, -9, 9, -9, 9, 9, 3, 2, 0, 0, 0, 2, 0, 0, 0, -2, 0, -2, 0, 0, 0, -2, 2, 0, 0}(1/24)};nv[[6, 3, 5, 1, 1]]= {{1, -1, 0, 0, 0, 0}(3/2)};nv[[6, 3, 5, 1, 2]]= {{1, -1, 0, 0, 0, 0}(3/2)};nv[[6, 3, 5, 1, 3]]= {{-2, 2, 1, -1, 0, 0}(1/2)};nv[[6, 3, 5, 1, 4]]= {{-1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 3, 5, 1, 5]]= {{-1, -3, 3, 1, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 5, 1, 6]]= {{-1, -3, 3, 1, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 5, 1, 7]]= {{1, 3, 0, 0, 0, 0, -3, -1, -1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 5, 2, 1]]= {{1, -1, 0, 0, 0, 0}(2)};nv[[6, 3, 5, 2, 2]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 2, 3]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 2, 4]]= {{-1, -1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 2, 5]]= {{-1, -1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 2, 6]]= {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 2, 7]]= {{1, 1, 1, 1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 5, 3, 1]]= {{1, -1, 0, 0, 0, 0}(3/2)};nv[[6, 3, 5, 3, 2]]= {{-2, 2, 1, -1, 0, 0}(1/2)};nv[[6, 3, 5, 3, 3]]= {{1, -1, 0, 0, 0, 0}(3/2)};nv[[6, 3, 5, 3, 4]]= {{-1, -3, 3, 1, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 5, 3, 5]]= {{-1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 3, 5, 3, 6]]= {{-1, 3, -3, 1, 0, 0, 0, 0, 0, -1, 1, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 5, 3, 7]]= {{1, 0, 3, 0, 0, -3, 0, -1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 5, 4, 1]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 4, 2]]= {{1, -1, 0, 0, 0, 0}(2)};nv[[6, 3, 5, 4, 3]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 4, 4]]= {{-1, 1, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 4, 5]]= {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 4, 6]]= {{-1, -1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 4, 7]]= {{1, 1, -1, -1, 1, 1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 5, 5, 1]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 5, 2]]= {{0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 5, 3]]= {{1, -1, 0, 0, 0, 0}(2)};nv[[6, 3, 5, 5, 4]]= {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 5, 5]]= {{-1, 1, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 5, 6]]= {{-1, 1, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 5, 5, 7]]= {{1, -1, 1, -1, 1, -1, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 5, 6, 1]]= {{-2, 2, 1, -1, 0, 0}(1/2)};nv[[6, 3, 5, 6, 2]]= {{1, -1, 0, 0, 0, 0}(3/2)};nv[[6, 3, 5, 6, 3]]= {{1, -1, 0, 0, 0, 0}(3/2)};nv[[6, 3, 5, 6, 4]]= {{-1, 3, -3, 1, 0, 0, 0, 0, 0, -1, 1, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 5, 6, 5]]= {{-1, 3, -3, 1, 0, 0, 0, 0, 0, -1, 1, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 5, 6, 6]]= {{-1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 3, 5, 6, 7]]= {{1, 0, 0, -3, 3, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0}(1/2)}; n0[[6, 3, 4, 1]]= {5/2};n0[[6, 3, 4, 2]]= {5/2};n0[[6, 3, 4, 3]]= {5/2};n0[[6, 3, 6, 1]]= {-6};n0[[6, 3, 6, 2]]= {-6};n0[[6, 3, 6, 3]]= {-6};n0[[6, 3, 6, 4]]= {-6};n0[[6, 3, 6, 5]]= {-6};n0[[6, 3, 6, 6]]= {-8};n0[[6, 3, 6, 7]]= {-6};n0[[6, 3, 6, 8]]= {-6};n0[[6, 3, 6, 9]]= {-6};n0[[6, 3, 6, 10]]= {-6}; nv[[6, 3, 4, 1, 1]]= {{-17, -17, 2, 2, 0, 0}(1/12)};nv[[6, 3, 4, 1, 2]]= {{-17, -17, 2, 2, 0, 0}(1/12)};nv[[6, 3, 4, 1, 3]]= {{-16, -16, 1, 1, 0, 0}(1/12)};nv[[6, 3, 4, 1, 4]]= {{-2, 21, 21, -2, 0, -2, -2, 0, 0, -2, -2, 0, 0, 0, 0, 0, 0, 0}(1/12)};nv[[6, 3, 4, 1, 5]]= {{18, 18, 18, 18, -1, -1, -1, -1, -2, -2, -2, -2, 0, 0, 0, 0, 0, 0}(1/24)};nv[[6, 3, 4, 1, 6]]= {{18, 18, 18, 18, -1, -1, -1, -1, -2, -2, -2, -2, 0, 0, 0, 0, 0, 0}(1/24)};nv[[6, 3, 4, 1, 7]]= {{2, 2, -22, -22, -22, -22, 2, 2, 0, 1, 1, 0, 2, 2, 1, 1, 0, 2, 2, 0, 0, 2, 2, 2, 2, 0}(1/24)};nv[[6, 3, 4, 2, 1]]= {{-17, -17, 2, 2, 0, 0}(1/12)};nv[[6, 3, 4, 2, 2]]= {{-16, -16, 1, 1, 0, 0}(1/12)};nv[[6, 3, 4, 2, 3]]= {{-17, -17, 2, 2, 0, 0}(1/12)};nv[[6, 3, 4, 2, 4]]= {{18, 18, 18, 18, -1, -1, -1, -1, -2, -2, -2, -2, 0, 0, 0, 0, 0, 0}(1/24)};nv[[6, 3, 4, 2, 5]]= {{-2, 21, 21, -2, 0, -2, -2, 0, 0, -2, -2, 0, 0, 0, 0, 0, 0, 0}(1/12)};nv[[6, 3, 4, 2, 6]]= {{18, 18, 18, 18, -2, -2, -2, -2, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0}(1/24)};nv[[6, 3, 4, 2, 7]]= {{2, -22, 2, -22, -22, 2, -22, 2, 2, 0, 2, 1, 0, 1, 2, 0, 2, 1, 0, 1, 2, 0, 2, 2, 0, 2}(1/24)};nv[[6, 3, 4, 3, 1]]= {{-16, -16, 1, 1, 0, 0}(1/12)};nv[[6, 3, 4, 3, 2]]= {{-17, -17, 2, 2, 0, 0}(1/12)};nv[[6, 3, 4, 3, 3]]= {{-17, -17, 2, 2, 0, 0}(1/12)};nv[[6, 3, 4, 3, 4]]= {{18, 18, 18, 18, -2, -2, -2, -2, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0}(1/24)};nv[[6, 3, 4, 3, 5]]= {{18, 18, 18, 18, -2, -2, -2, -2, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0}(1/24)};nv[[6, 3, 4, 3, 6]]= {{-2, 21, 21, -2, 0, -2, -2, 0, 0, -2, -2, 0, 0, 0, 0, 0, 0, 0}(1/12)};nv[[6, 3, 4, 3, 7]]= {{2, -22, -22, 2, 2, -22, -22, 2, 2, 2, 0, 2, 2, 0, 0, 2, 2, 0, 2, 2, 1, 1, 0, 0, 1, 1}(1/24)};nv[[6, 3, 6, 1, 1]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 1, 2]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 1, 3]]= {{4, 4, -1, -1, 0, 0}};nv[[6, 3, 6, 1, 4]]= {{0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 1, 5]]= {{-4, -4, -4, -4, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 1, 6]]= {{-4, -4, -4, -4, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 1, 7]]= {{0, 0, 4, 4, 4, 4, 0, 0, 0, -1, -1, 0, 0, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 2, 1]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 2, 2]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 2, 3]]= {{4, 4, -1, -1, 0, 0}};nv[[6, 3, 6, 2, 4]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 3, 6, 2, 5]]= {{-1, -3, -3, -1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 6, 2, 6]]= {{-4, -4, -4, -4, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 2, 7]]= {{1, 3, 1, 3, 3, 1, 3, 1, -1, 0, -1, 0, 0, 0, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 3, 1]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 3, 2]]= {{4, 4, -1, -1, 0, 0}};nv[[6, 3, 6, 3, 3]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 3, 4]]= {{-1, -3, -3, -1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 6, 3, 5]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 3, 6, 3, 6]]= {{-4, -4, -4, -4, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 3, 7]]= {{1, 1, 3, 3, 3, 3, 1, 1, 0, 0, 0, 0, -1, -1, 0, 0, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 4, 1]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 4, 2]]= {{4, 4, -1, -1, 0, 0}};nv[[6, 3, 6, 4, 3]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 4, 4]]= {{-4, -4, -4, -4, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 4, 5]]= {{0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 4, 6]]= {{-4, -4, -4, -4, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 4, 7]]= {{0, 4, 0, 4, 4, 0, 4, 0, 0, 0, 0, -1, 0, -1, 0, 0, 0, -1, 0, -1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 5, 1]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 5, 2]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 5, 3]]= {{4, 4, -1, -1, 0, 0}};nv[[6, 3, 6, 5, 4]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 3, 6, 5, 5]]= {{-4, -4, -4, -4, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 5, 6]]= {{-1, -3, -3, -1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 6, 5, 7]]= {{1, 3, 3, 1, 1, 3, 3, 1, -1, -1, 0, 0, 0, 0, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 6, 1]]= {{1, 1, 0, 0, 0, 0}(4)};nv[[6, 3, 6, 6, 2]]= {{1, 1, 0, 0, 0, 0}(4)};nv[[6, 3, 6, 6, 3]]= {{1, 1, 0, 0, 0, 0}(4)};nv[[6, 3, 6, 6, 4]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(2)};nv[[6, 3, 6, 6, 5]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(2)};nv[[6, 3, 6, 6, 6]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(2)};nv[[6, 3, 6, 6, 7]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 6, 7, 1]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 7, 2]]= {{4, 4, -1, -1, 0, 0}};nv[[6, 3, 6, 7, 3]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 7, 4]]= {{-4, -4, -4, -4, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 7, 5]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 3, 6, 7, 6]]= {{-1, -3, -3, -1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 6, 7, 7]]= {{1, 3, 3, 1, 1, 3, 3, 1, 0, 0, 0, -1, -1, 0, 0, 0, 0, 0, -1, -1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 8, 1]]= {{4, 4, -1, -1, 0, 0}};nv[[6, 3, 6, 8, 2]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 8, 3]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 8, 4]]= {{-1, -3, -3, -1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 6, 8, 5]]= {{-4, -4, -4, -4, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 8, 6]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 3, 6, 8, 7]]= {{1, 1, 3, 3, 3, 3, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, -1, -1, 0}(1/2)};nv[[6, 3, 6, 9, 1]]= {{4, 4, -1, -1, 0, 0}};nv[[6, 3, 6, 9, 2]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 9, 3]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 9, 4]]= {{-4, -4, -4, -4, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 9, 5]]= {{-1, -3, -3, -1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 3, 6, 9, 6]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 3, 6, 9, 7]]= {{1, 3, 1, 3, 3, 1, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, -1, -1, 0, -1}(1/2)};nv[[6, 3, 6, 10, 1]]= {{4, 4, -1, -1, 0, 0}};nv[[6, 3, 6, 10, 2]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 10, 3]]= {{1, 1, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 10, 4]]= {{-4, -4, -4, -4, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 10, 5]]= {{-4, -4, -4, -4, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 3, 6, 10, 6]]= {{0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3)};nv[[6, 3, 6, 10, 7]]= {{0, 4, 4, 0, 0, 4, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, -1, 0, 0, -1, -1}(1/2)};

av[1]={0, 0, 0, 0, 0, 0};
av[2]={0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
av[3]={1, -1, 0, 0, 0, 0};
av[4]={-1, 1, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2);
av[5]={-1, -1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2);
av[6]={1, 1, -1, -1, 1, 1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/4);
av[7]={1, -1, 1, -1, 1, -1, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/4);
av[8]={-1, 1, 1, -1, 1, -1, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/4);
av[9]={1, 1, 1, 1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/4);
av[10]={0, 1, -1, 0, -1, 0, 0, 1, -1, 0, 0, 1, 0, 1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/4);
av[11]={0, -1, 1, 0, -1, 0, 0, 1, -1, 0, 0, 1, 0, -1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/4);
av[12]={0, -1, -1, 0, 1, 0, 0, 1, -1, 0, 0, -1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/4);
av[13]={0, -1, -1, 0, -1, 0, 0, -1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/4);
 nv[[6, 4, 5, 1, 1]]= {av[1]};nv[[6, 4, 5, 1, 2]]= {av[1]};nv[[6, 4, 5, 1, 3]]= {av[1]};nv[[6, 4, 5, 1, 4]]= {av[3]};nv[[6, 4, 5, 1, 5]]= {av[2]};nv[[6, 4, 5, 1, 6]]={av[2]};nv[[6, 4, 5, 1, 7]]= {av[4]};nv[[6, 4, 5, 1, 8]]= {av[2]};nv[[6, 4, 5, 1, 9]]= {av[4]};nv[[6, 4, 5, 1, 10]]= {av[4]};nv[[6, 4, 5, 1, 11]]= {av[8]};nv[[6, 4, 5, 1, 12]]= {av[7]};nv[[6, 4, 5, 1, 13]]= {av[7]};nv[[6, 4, 5, 1, 14]]= {av[7]};nv[[6, 4, 5, 1, 15]]= {av[10]};
nv[[6, 4, 5, 2, 1]]= {av[1]};nv[[6, 4, 5, 2, 2]]= {av[1]};nv[[6, 4, 5, 2, 3]]= {av[3]};nv[[6, 4, 5, 2, 4]]= {av[1]};nv[[6, 4, 5, 2, 5]]= {av[2]};nv[[6, 4, 5, 2, 6]]= {av[4]};nv[[6, 4, 5, 2, 7]]= {av[2]};nv[[6, 4, 5, 2, 8]]=  {av[4]};nv[[6, 4, 5, 2, 9]]= {av[2]};nv[[6, 4, 5, 2, 10]]= {av[5]};nv[[6, 4, 5, 2, 11]]= {av[7]};nv[[6, 4, 5, 2, 12]]= {av[8]};nv[[6, 4, 5, 2, 13]]= {av[6]};nv[[6, 4, 5, 2, 14]]= {av[6]};nv[[6, 4, 5, 2, 15]]= {av[11]};nv[[6, 4, 5, 3, 1]]= {av[1]};nv[[6, 4, 5, 3, 2]]={av[3]};nv[[6, 4, 5, 3, 3]]= {av[1]};nv[[6, 4, 5, 3, 4]]= {av[1]};nv[[6, 4, 5, 3, 5]]= {av[4]};nv[[6, 4, 5, 3, 6]]= {av[2]};nv[[6, 4, 5, 3, 7]]= {av[2]};nv[[6, 4, 5, 3, 8]]= {av[5]};nv[[6, 4, 5, 3, 9]]= {av[5]};nv[[6, 4, 5, 3, 10]]= {av[2]};nv[[6, 4, 5, 3, 11]]= {av[6]};nv[[6, 4, 5, 3, 12]]= {av[6]};nv[[6, 4, 5, 3, 13]]= {av[8]};nv[[6, 4, 5, 3, 14]]= {av[9]};nv[[6, 4, 5, 3, 15]]= {av[12]};nv[[6, 4, 5, 4, 1]]= {av[3]};nv[[6, 4, 5, 4, 2]]= {av[1]};nv[[6, 4, 5, 4, 3]]= {av[1]};nv[[6, 4, 5, 4, 4]]= {av[1]};nv[[6, 4, 5, 4, 5]]= {av[5]};nv[[6, 4, 5, 4, 6]]= {av[5]};nv[[6, 4, 5, 4, 7]]= {av[5]};nv[[6, 4, 5, 4, 8]]=  {av[2]};nv[[6, 4, 5, 4, 9]]=  {av[2]};nv[[6, 4, 5, 4, 10]]= {av[2]};nv[[6, 4, 5, 4, 11]]= {av[9]};nv[[6, 4, 5, 4, 12]]= {av[9]};nv[[6, 4, 5, 4, 13]]= {av[9]};nv[[6, 4, 5, 4, 14]]= {av[8]};nv[[6, 4, 5, 4, 15]]= {av[13]}; 

n0[[6, 4, 4, 1]]= {-39};n0[[6, 4, 6, 1]]= {57};n0[[6, 4, 6, 2]]= {-4};n0[[6, 4, 6, 3]]= {57};n0[[6, 4, 6, 4]]= {-4};n0[[6, 4, 6, 5]]= {-4};n0[[6, 4, 6, 6]]= {57};n0[[6, 4, 6, 7]]= {-4};n0[[6, 4, 6, 8]]= {-4};n0[[6, 4, 6, 9]]= {-4};n0[[6, 4, 6, 10]]= {57}; 

av[1]={19, 19, -1, -1, 0, 0}(11/12);
av[2]={-83, -93, -93, -83, 3, 4, 4, 3, 3, 4, 4, 3, 0, 0, 0, 0, 0, 0}(1/12);
av[3]={51, 73, 73, 73, 73, 73, 73, 51, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2, -2}(1/24);
av[4]={0, -25, -25, -24, -25, -24, -24, -25, -25, -24, -24, -25, -24, -25, -25, 0, -2, -2, -2, -2, -2, -2, -2, -2}(1/24);
av[5]={-1, -1, 0, 0, 0, 0}(45/2);
av[6]={-68, -68, 11, 11, 0, 0}(1/2);
av[7]={5, 6, 6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2);
av[8]={25, 27, 27, 25, -3, -4, -4, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2);
nv[[6, 4, 4, 1, 1]]= {av[1]};nv[[6, 4, 4, 1, 2]]= {av[1]};nv[[6, 4, 4, 1, 3]]= {av[1]};nv[[6, 4, 4, 1, 4]]= {av[1]};nv[[6, 4, 4, 1, 5]]= {av[2]};nv[[6, 4, 4, 1, 6]]= {av[2]};nv[[6, 4, 4, 1, 7]]= {av[2]};nv[[6, 4, 4, 1, 8]]= {av[2]};nv[[6, 4, 4, 1, 9]]= {av[2]};nv[[6, 4, 4, 1, 10]]={av[2]};nv[[6, 4, 4, 1, 11]]= {av[3]};nv[[6, 4, 4, 1, 12]]= {av[3]};nv[[6, 4, 4, 1, 13]]= {av[3]};nv[[6, 4, 4, 1, 14]]= {av[3]};nv[[6, 4, 4, 1, 15]]= {av[4]};nv[[6, 4, 6, 1, 1]]= {av[5]};nv[[6, 4, 6, 1, 2]]= {av[5]};nv[[6, 4, 6, 1, 3]]= {av[5]};nv[[6, 4, 6, 1, 4]]= {av[6]};nv[[6, 4, 6, 1, 5]]= {av[7]};nv[[6, 4, 6, 1, 6]]= {av[7]};nv[[6, 4, 6, 1, 7]]= {av[8]};nv[[6, 4, 6, 1, 8]]= {av[7]};nv[[6, 4, 6, 1, 9]]= {av[8]};nv[[6, 4, 6, 1, 10]]={av[8]};nv[[6, 4, 6, 1, 11]]= {{-1, -2, -2, -2, -2, -2, -2, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 1, 12]]= {{-7, -9, -10, -10, -10, -10, -9, -7, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 1, 13]]= {{-7, -9, -10, -10, -10, -10, -9, -7, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 1, 14]]= {{-7, -9, -10, -10, -10, -10, -9, -7, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 1, 15]]= {{0, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 0, 1, 0, 0, 1, 0, 0, 0, 0}(1/2)};


nv[[6, 4, 6, 2, 1]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 2, 2]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 2, 3]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 2, 4]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 2, 5]]= {{0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 2, 6]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 2, 7]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 2, 8]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 2, 9]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 2, 10]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 2, 11]]= {{0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 2, 12]]= {{0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 2, 13]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 2, 14]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 2, 15]]= {{0, 0, 0, 0, -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 3, 1]]= {{-1, -1, 0, 0, 0, 0}(45/2)};nv[[6, 4, 6, 3, 2]]= {{-1, -1, 0, 0, 0, 0}(45/2)};nv[[6, 4, 6, 3, 3]]= {{-68, -68, 11, 11, 0, 0}(1/2)};nv[[6, 4, 6, 3, 4]]= {{-1, -1, 0, 0, 0, 0}(45/2)};nv[[6, 4, 6, 3, 5]]= {{5, 6, 6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 3, 6]]= {{25, 27, 27, 25, -3, -4, -4, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 3, 7]]= {{5, 6, 6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 3, 8]]= {{25, 27, 27, 25, -3, -4, -4, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 3, 9]]= {{5, 6, 6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 3, 10]]= {{25, 27, 27, 25, 0, 0, 0, 0, -3, -4, -4, -3, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 3, 11]]= {{-7, -9, -10, -10, -10, -10, -9, -7, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 3, 12]]= {{-1, -2, -2, -2, -2, -2, -2, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 3, 13]]= {{-7, -10, -9, -10, -10, -9, -10, -7, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 3, 14]]= {{-7, -10, -9, -10, -10, -9, -10, -7, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 3, 15]]= {{0, 3, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2, 3, 0, 0, 1, 0, 0, 1, 0, 0, 0}(1/2)};nv[[6, 4, 6, 4, 1]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 4, 2]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 4, 3]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 4, 4]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 4, 5]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 4, 6]]= {{0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 4, 7]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 4, 8]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 4, 9]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 4, 10]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 4, 11]]= {{0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 4, 12]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 4, 13]]= {{0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 4, 14]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 4, 15]]= {{0, 0, -1, -1, 0, 0, -1, -1, -1, -1, 0, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 5, 1]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 5, 2]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 5, 3]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 5, 4]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 5, 5]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 5, 6]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 5, 7]]= {{0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 5, 8]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 5, 9]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 5, 10]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 5, 11]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 5, 12]]= {{0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 5, 13]]= {{0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 5, 14]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 5, 15]]= {{0, -1, 0, -1, 0, -1, 0, -1, -1, 0, -1, 0, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 6, 1]]= {{-1, -1, 0, 0, 0, 0}(45/2)};nv[[6, 4, 6, 6, 2]]= {{-68, -68, 11, 11, 0, 0}(1/2)};nv[[6, 4, 6, 6, 3]]= {{-1, -1, 0, 0, 0, 0}(45/2)};nv[[6, 4, 6, 6, 4]]= {{-1, -1, 0, 0, 0, 0}(45/2)};nv[[6, 4, 6, 6, 5]]= {{25, 27, 27, 25, -3, -4, -4, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 6, 6]]= {{5, 6, 6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 6, 7]]= {{5, 6, 6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 6, 8]]= {{25, 27, 27, 25, 0, 0, 0, 0, -3, -4, -4, -3, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 6, 9]]= {{25, 27, 27, 25, 0, 0, 0, 0, -3, -4, -4, -3, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 6, 10]]= {{5, 6, 6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 6, 11]]= {{-7, -10, -9, -10, -10, -9, -10, -7, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 6, 12]]= {{-7, -10, -9, -10, -10, -9, -10, -7, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 6, 13]]= {{-1, -2, -2, -2, -2, -2, -2, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 6, 14]]= {{-7, -10, -10, -9, -9, -10, -10, -7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1}(1/2)};nv[[6, 4, 6, 6, 15]]= {{0, 3, 3, 3, 2, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 0, 0, 0, 1, 0, 0, 1, 0, 0}(1/2)};nv[[6, 4, 6, 7, 1]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 7, 2]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 7, 3]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 7, 4]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 7, 5]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 7, 6]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 7, 7]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 7, 8]]= {{0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 7, 9]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 7, 10]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 7, 11]]= {{0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 7, 12]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 7, 13]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 7, 14]]= {{0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 7, 15]]= {{0, 0, -1, -1, -1, -1, 0, 0, 0, 0, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 8, 1]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 8, 2]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 8, 3]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 8, 4]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 8, 5]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 8, 6]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 8, 7]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 8, 8]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 8, 9]]= {{0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 8, 10]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 8, 11]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 8, 12]]= {{0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 8, 13]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 8, 14]]= {{0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 8, 15]]= {{0, -1, 0, -1, -1, 0, -1, 0, 0, -1, 0, -1, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 9, 1]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 9, 2]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 9, 3]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 9, 4]]= {{1, 1, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 9, 5]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 9, 6]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 9, 7]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 9, 8]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 9, 9]]= {{-1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 9, 10]]= {{0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(2)};nv[[6, 4, 6, 9, 11]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 9, 12]]= {{1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 9, 13]]= {{0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 9, 14]]= {{0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};nv[[6, 4, 6, 9, 15]]= {{0, -1, -1, 0, 0, -1, -1, 0, 0, -1, -1, 0, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 10, 1]]= {{-68, -68, 11, 11, 0, 0}(1/2)};nv[[6, 4, 6, 10, 2]]= {{-1, -1, 0, 0, 0, 0}(45/2)};nv[[6, 4, 6, 10, 3]]= {{-1, -1, 0, 0, 0, 0}(45/2)};nv[[6, 4, 6, 10, 4]]= {{-1, -1, 0, 0, 0, 0}(45/2)};nv[[6, 4, 6, 10, 5]]= {{25, 27, 27, 25, 0, 0, 0, 0, -3, -4, -4, -3, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 10, 6]]= {{25, 27, 27, 25, 0, 0, 0, 0, -3, -4, -4, -3, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 10, 7]]= {{25, 27, 27, 25, 0, 0, 0, 0, -3, -4, -4, -3, 0, 0, 0, 0, 0, 0}(1/2)};nv[[6, 4, 6, 10, 8]]= {{5, 6, 6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 10, 9]]= {{5, 6, 6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 10, 10]]= {{5, 6, 6, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 10, 11]]= {{-7, -10, -10, -9, -9, -10, -10, -7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1}(1/2)};nv[[6, 4, 6, 10, 12]]= {{-7, -10, -10, -9, -9, -10, -10, -7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1}(1/2)};nv[[6, 4, 6, 10, 13]]= {{-7, -10, -10, -9, -9, -10, -10, -7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1}(1/2)};nv[[6, 4, 6, 10, 14]]= {{-1, -2, -2, -2, -2, -2, -2, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(3/2)};nv[[6, 4, 6, 10, 15]]= {{0, 3, 3, 3, 3, 3, 3, 2, 2, 3, 3, 3, 3, 3, 3, 0, 0, 0, 0, 0, 0, 0, 1, 1}(1/2)};

av[1]={-1, 1, 0, 0, 0, 0}(7/2);
av[2]={1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(5/2);
av[3]={-2, -1, -1, 1, -1, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/2);
av[4]={0, 1, 1, 0, 1, 0, 0, -1, 1, 0, 0, -1, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/4);
nv[[6, 5, 5, 1, 1]]= {av[1]};nv[[6, 5, 5, 1, 2]]= {av[1]};nv[[6, 5, 5, 1, 3]]= {av[1]};nv[[6, 5, 5, 1, 4]]= {av[1]};nv[[6, 5, 5, 1, 5]]= {av[1]};nv[[6, 5, 5, 1, 6]]= {av[2]};nv[[6, 5, 5, 1, 7]]= {av[2]};nv[[6, 5, 5, 1, 8]]= {av[2]};nv[[6, 5, 5, 1, 9]]= {av[2]};nv[[6, 5, 5, 1, 10]]= {av[2]};nv[[6, 5, 5, 1, 11]]= {av[2]};nv[[6, 5, 5, 1, 12]]= {av[2]};nv[[6, 5, 5, 1, 13]]= {av[2]};nv[[6, 5, 5, 1, 14]]={av[2]};nv[[6, 5, 5, 1, 15]]= {av[2]};nv[[6, 5, 5, 1, 16]]= {av[3]};nv[[6, 5, 5, 1, 17]]= {av[3]};nv[[6, 5, 5, 1, 18]]= {av[3]};nv[[6, 5, 5, 1, 19]]= {av[3]};nv[[6, 5, 5, 1, 20]]= {av[3]};nv[[6, 5, 5, 1, 21]]= {av[3]};nv[[6, 5, 5, 1, 22]]= {av[3]};nv[[6, 5, 5, 1, 23]]= {av[3]};nv[[6, 5, 5, 1, 24]]= {av[3]};nv[[6, 5, 5, 1, 25]]= {av[3]};nv[[6, 5, 5, 1, 26]]= {av[4]};nv[[6, 5, 5, 1, 27]]= {av[4]};nv[[6, 5, 5, 1, 28]]= {av[4]};nv[[6, 5, 5, 1, 29]]= {av[4]};nv[[6, 5, 5, 1, 30]]= {av[4]};nv[[6, 5, 5, 1, 31]]= {{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1}(1/2)}; 

n0[[6, 5, 6, 1]]= {-14/3};n0[[6, 5, 6, 2]]= {-14/3};n0[[6, 5, 6, 3]]= {-14/3};n0[[6, 5, 6, 4]]= {-14/3};n0[[6, 5, 6, 5]]= {-14/3}; nv[[6, 5, 6, 1, 1]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 1, 2]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 1, 3]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 1, 4]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 1, 5]]= {{1, 1, 0, 0, 0, 0}(5)};nv[[6, 5, 6, 1, 6]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 1, 7]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 1, 8]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 1, 9]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 10]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 1, 11]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 1, 12]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 13]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 1, 14]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 15]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 16]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 17]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 18]]= {{2, 6, 3, 3, 3, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 19]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 20]]= {{2, 6, 3, 3, 3, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 21]]= {{2, 6, 3, 3, 3, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 22]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 23]]= {{2, 6, 3, 3, 3, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 24]]= {{2, 6, 3, 3, 3, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 25]]= {{2, 6, 3, 3, 3, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 26]]= {{0, 3, 3, 2, 3, 2, 2, 3, 3, 2, 2, 3, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 27]]= {{0, -3, 0, -1, 0, -1, -1, 0, 0, -1, -1, 0, -1, 0, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 28]]= {{0, -3, 0, -1, 0, -1, -1, 0, 0, -1, -1, 0, -1, 0, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 29]]= {{0, -3, 0, -1, 0, -1, -1, 0, 0, -1, -1, 0, -1, 0, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 30]]= {{0, -3, 0, -1, 0, -1, -1, 0, 0, -1, -1, 0, -1, 0, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 1, 31]]= {{0, 2, -1, -1, -1, -1, -1, -1, -1, -1, 2, 0}(1/6)};nv[[6, 5, 6, 2, 1]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 2, 2]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 2, 3]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 2, 4]]= {{1, 1, 0, 0, 0, 0}(5)};nv[[6, 5, 6, 2, 5]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 2, 6]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 2, 7]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 2, 8]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 9]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 2, 10]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 2, 11]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 12]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 2, 13]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 14]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 2, 15]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 16]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 17]]= {{2, 6, 3, 3, 3, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 18]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 19]]= {{2, 6, 3, 3, 3, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 20]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 21]]= {{2, 3, 6, 3, 3, 6, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 22]]= {{2, 6, 3, 3, 3, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 23]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 24]]= {{2, 3, 6, 3, 3, 6, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 25]]= {{2, 3, 6, 3, 3, 6, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 26]]= {{0, -3, 0, -1, 0, -1, -1, 0, 0, -1, -1, 0, -1, 0, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 27]]= {{0, 3, 3, 2, 3, 2, 2, 3, 3, 2, 2, 3, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 28]]= {{0, 0, -3, -1, 0, -1, -1, 0, 0, -1, -1, 0, -1, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 29]]= {{0, 0, -3, -1, 0, -1, -1, 0, 0, -1, -1, 0, -1, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 30]]= {{0, 0, -3, -1, 0, -1, -1, 0, 0, -1, -1, 0, -1, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 2, 31]]= {{0, -1, 2, -1, -1, -1, -1, -1, -1, 2, -1, 0}(1/6)};nv[[6, 5, 6, 3, 1]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 3, 2]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 3, 3]]= {{1, 1, 0, 0, 0, 0}(5)};nv[[6, 5, 6, 3, 4]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 3, 5]]= {{1, 1, 0, 0, 0, 0}};nv[[6, 5, 6, 3, 6]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 3, 7]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 8]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 3, 9]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 3, 10]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 11]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 3, 12]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 3, 13]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 14]]= {{-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 15]]= {{0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3)};nv[[6, 5, 6, 3, 16]]= {{2, 6, 3, 3, 3, 3, 6, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 17]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 18]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 19]]= {{2, 3, 6, 3, 3, 6, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 20]]= {{2, 3, 6, 3, 3, 6, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 21]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 22]]= {{2, 3, 6, 3, 3, 6, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 23]]= {{2, 3, 6, 3, 3, 6, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 24]]= {{-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 25]]= {{2, 3, 3, 6, 6, 3, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 26]]= {{0, 0, -3, -1, 0, -1, -1, 0, 0, -1, -1, 0, -1, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 27]]= {{0, 0, -3, -1, 0, -1, -1, 0, 0, -1, -1, 0, -1, -3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 28]]= {{0, 3, 3, 2, 3, 2, 2, 3, 3, 2, 2, 3, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 29]]= {{0, 0, 0, -1, -3, -1, -1, 0, 0, -1, -1, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 30]]= {{0, 0, 0, -1, -3, -1, -1, 0, 0, -1, -1, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6)};nv[[6, 5, 6, 3, 31]]= {{0, -1, -1, 2, -1, -1, -1, -1, 2, -1, -1, 0}(1/6)};

av[1]={1, 1, 0, 0, 0, 0};
av[2]={-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6);
av[3]={0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/3);
av[4]={2, 3, 6, 3, 3, 6, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6);
av[5]={-1, -3, -3, -3, -3, -3, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6);
av[6]={2, 3, 3, 6, 6, 3, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6);
av[7]={0, 0, 0, -1, -3, -1, -1, 0, 0, -1, -1, -3, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6);
av[8]={0, 0, 0, -1, 0, -1, -1, -3, -3, -1, -1, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6);
av[9]={0, 3, 3, 2, 3, 2, 2, 3, 3, 2, 2, 3, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6);
av[10]={-9, -13, -13, -9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}(1/6);
nv[[6, 5, 6, 4, 1]]= {av[1]};nv[[6, 5, 6, 4, 2]]= {av[1](5)};nv[[6, 5, 6, 4, 3]]= {av[1]};nv[[6, 5, 6, 4, 4]]= {av[1]};nv[[6, 5, 6, 4, 5]]= {av[1]};nv[[6, 5, 6, 4, 6]]= {av[2]};nv[[6, 5, 6, 4, 7]]= {av[3]};nv[[6, 5, 6, 4, 8]]= {av[3]};nv[[6, 5, 6, 4, 9]]= {av[3]};nv[[6, 5, 6, 4, 10]]= {av[2]};nv[[6, 5, 6, 4, 11]]= {av[2]};nv[[6, 5, 6, 4, 12]]= {av[2]};nv[[6, 5, 6, 4, 13]]= {av[3]};nv[[6, 5, 6, 4, 14]]= {av[3]};nv[[6, 5, 6, 4, 15]]= {av[3]};nv[[6, 5, 6, 4, 16]]= {av[4]};nv[[6, 5, 6, 4, 17]]= {av[4]};nv[[6, 5, 6, 4, 18]]= {av[4]};nv[[6, 5, 6, 4, 19]]= {av[5]};nv[[6, 5, 6, 4, 20]]= {av[5]};nv[[6, 5, 6, 4, 21]]= {av[5]};nv[[6, 5, 6, 4, 22]]= {av[6]};nv[[6, 5, 6, 4, 23]]= {av[6]};nv[[6, 5, 6, 4, 24]]= {av[6]};nv[[6, 5, 6, 4, 25]]= {av[5]};nv[[6, 5, 6, 4, 26]]= {av[7]};nv[[6, 5, 6, 4, 27]]= {av[7]};nv[[6, 5, 6, 4, 28]]= {av[7]};nv[[6, 5, 6, 4, 29]]= {av[9]};nv[[6, 5, 6, 4, 30]]= {av[8]};
nv[[6, 5, 6, 4, 31]]= {{0, -1, -1, -1, 2, -1, -1, 2, -1, -1, -1, 0}(1/6)};
nv[[6, 5, 6, 5, 1]]= {av[1](5)};nv[[6, 5, 6, 5, 2]]= {av[1]};nv[[6, 5, 6, 5, 3]]= {av[1]};nv[[6, 5, 6, 5, 4]]= {av[1]};nv[[6, 5, 6, 5, 5]]= {av[1]};nv[[6, 5, 6, 5, 6]]= {av[10]};nv[[6, 5, 6, 5, 7]]= {av[10]};nv[[6, 5, 6, 5, 8]]={av[10]};nv[[6, 5, 6, 5, 9]]= {av[10]};nv[[6, 5, 6, 5, 10]]= {av[3]};nv[[6, 5, 6, 5, 11]]= {av[3]};nv[[6, 5, 6, 5, 12]]= {av[3]};nv[[6, 5, 6, 5, 13]]= {av[3]};nv[[6, 5, 6, 5, 14]]= {av[3]};nv[[6, 5, 6, 5, 15]]= {av[3]};nv[[6, 5, 6, 5, 16]]= {av[6]};nv[[6, 5, 6, 5, 17]]=  {av[6]};nv[[6, 5, 6, 5, 18]]=  {av[6]};nv[[6, 5, 6, 5, 19]]=  {av[6]};nv[[6, 5, 6, 5, 20]]=  {av[6]};nv[[6, 5, 6, 5, 21]]=  {av[6]};nv[[6, 5, 6, 5, 22]]= {av[5]};nv[[6, 5, 6, 5, 23]]= {av[5]};nv[[6, 5, 6, 5, 24]]= {av[5]};nv[[6, 5, 6, 5, 25]]= {av[5]};nv[[6, 5, 6, 5, 26]]= {av[8]};nv[[6, 5, 6, 5, 27]]= {av[8]};nv[[6, 5, 6, 5, 28]]= {av[8]};nv[[6, 5, 6, 5, 29]]= {av[8]};nv[[6, 5, 6, 5, 30]]= {av[9]};nv[[6, 5, 6, 5, 31]]= {{0, -1, -1, -1, -1, 2, 2, -1, -1, -1, -1, 0}(1/6)};

n0[[6,6,6,1]]={1};
av[1]={1,1,0,0,0,0}(-1/2);
av[2]={1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0}(1/2);
av[3]={1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}(-1/2);
av[4]={1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0}(1/2);
av[5]={1,0,0,0,0,0,0,0,0,0,0,1}(-1/2);
nv[[6,6,6,1,1]]={av[1]};nv[[6,6,6,1,2]]={av[1]};nv[[6,6,6,1,3]]={av[1]};
nv[[6,6,6,1,4]]={av[1]};nv[[6,6,6,1,5]]={av[1]};nv[[6,6,6,1,6]]={av[1]};
nv[[6,6,6,1,7]]={av[2]};nv[[6,6,6,1,8]]={av[2]};nv[[6,6,6,1,9]]={av[2]};
nv[[6,6,6,1,10]]={av[2]};nv[[6,6,6,1,11]]={av[2]};nv[[6,6,6,1,12]]={av[2]};nv[[6,6,6,1,13]]={av[2]};nv[[6,6,6,1,14]]={av[2]};nv[[6,6,6,1,15]]={av[2]};
nv[[6,6,6,1,16]]={av[2]};nv[[6,6,6,1,17]]={av[2]};nv[[6,6,6,1,18]]={av[2]};
nv[[6,6,6,1,19]]={av[2]};nv[[6,6,6,1,20]]={av[2]};nv[[6,6,6,1,21]]={av[2]};
nv[[6,6,6,1,22]]={av[3]};nv[[6,6,6,1,23]]={av[3]};nv[[6,6,6,1,24]]={av[3]};
nv[[6,6,6,1,25]]={av[3]};nv[[6,6,6,1,26]]={av[3]};nv[[6,6,6,1,27]]={av[3]};
nv[[6,6,6,1,28]]={av[3]};nv[[6,6,6,1,29]]={av[3]};nv[[6,6,6,1,30]]={av[3]};
nv[[6,6,6,1,31]]={av[3]};nv[[6,6,6,1,32]]={av[3]};nv[[6,6,6,1,33]]={av[3]};
nv[[6,6,6,1,34]]={av[3]};nv[[6,6,6,1,35]]={av[3]};nv[[6,6,6,1,36]]={av[3]};
nv[[6,6,6,1,37]]={av[3]};nv[[6,6,6,1,38]]={av[3]};nv[[6,6,6,1,39]]={av[3]};
nv[[6,6,6,1,40]]={av[3]};nv[[6,6,6,1,41]]={av[3]};
nv[[6,6,6,1,42]]={av[4]};nv[[6,6,6,1,43]]={av[4]};nv[[6,6,6,1,44]]={av[4]};
nv[[6,6,6,1,45]]={av[4]};nv[[6,6,6,1,46]]={av[4]};nv[[6,6,6,1,47]]={av[4]};
nv[[6,6,6,1,48]]={av[4]};nv[[6,6,6,1,49]]={av[4]};nv[[6,6,6,1,50]]={av[4]};
nv[[6,6,6,1,51]]={av[4]};nv[[6,6,6,1,52]]={av[4]};nv[[6,6,6,1,53]]={av[4]};
nv[[6,6,6,1,54]]={av[4]};nv[[6,6,6,1,55]]={av[4]};nv[[6,6,6,1,56]]={av[4]};
nv[[6,6,6,1,57]]={av[5]};nv[[6,6,6,1,58]]={av[5]};nv[[6,6,6,1,59]]={av[5]};
nv[[6,6,6,1,60]]={av[5]};nv[[6,6,6,1,61]]={av[5]};nv[[6,6,6,1,62]]={av[5]};
nv[[6,6,6,1,63]]={{1, 1}(1/2)};

mq=0;
If[nderx==0,nqx=1,nqx=Length[findx[dispder]]];

Edisp2=Table[nc,{j,Length[Edispmin]},{k,Length[disp2]}];
kmap=Table[0,{k,Length[dispmin]}];
Do[dp=Flatten[Position[disp2,dispmin[[k]]]];
If[Length[dp]==1,kmap[[k]]=dp[[1]];
Do[Edisp2[[j,kmap[[k]]]]=Edispmin[[j,k]],{j,Length[Edispmin]}]],{k,Length[dispmin]}];
If[Length[sxdisp]>0, Do[Edisp2[[1,sxdisp[[k]]]]=sx,{k,Length[sxdisp]}]];

Do[
Edisp=Table[nc,{k,npt}];mq=mq+1;
Do[r0[k]=findx[dispder][[iq,k]],{k,dispder}];

Do[Edisp[[Flatten[Position[disp,disp2[[k]]]][[1]]]]=Edisp2[[mq,k]],{k,Length[Edisp2[[mq]]]}];

If[Length[sym]!=0,
Do[
xx={dispmap[[1,k]],dispmap[[2,k]]};xy={disp[[xx[[1]]]],disp[[xx[[2]]]]};
xz=Flatten[Position[Sign[Abs[xy[[1]]-xy[[2]]]],1]];

opx={};
Do[If[Length[Complement[xz,symtot[[k]]]]==0,opx=Join[opx,{symtot[[k]]}]],{k,Length[symtot]}];
phases=Table[(-1)^Sum[Count[Table[r0[ky],{ky,dispder}],opx[[mx,kx]]],{kx,Length[opx[[mx]]]}],{mx,Length[opx]}];
phase=phases[[1]];

Edisp[[xx[[1]]]]=phase*Edisp[[xx[[2]]]],{k,nd}]];
     e0=Edisp[[Flatten[Position[disp,d0]][[1]]]];

If[degensym,
Do[

nnz=Length[degendisplist[[k]]]-Count[degendisplist[[k]],0];

If[nnz== 1,
kb=Complement[Range[Length[degendisplist[[k]]]],Flatten[Position[degendisplist[[k]],0]]][[1]];
ka=SEa[[Flatten[Position[SEb,kb]][[1]]]];
dsize=degendisplist[[k,kb]];

pkbp=Flatten[Position[disp,ReplacePart[d0,kb-> dsize]]][[1]];
pkbm=Flatten[Position[disp,ReplacePart[d0,kb-> -dsize]]][[1]];
pkap=Flatten[Position[disp,ReplacePart[d0,ka-> dsize]]][[1]];
pkam=Flatten[Position[disp,ReplacePart[d0,ka-> -dsize]]][[1]];
Edisp[[pkbp]]=(Edisp[[pkap]]+Edisp[[pkam]])/2;
Edisp[[pkbm]]=Edisp[[pkbp]]];

If[nnz== 2,
{jxd,kxd}=Complement[Range[Length[degendisplist[[k]]]],Flatten[Position[degendisplist[[k]],0]]];
dsizej=degendisplist[[k,jxd]];dsizek=degendisplist[[k,kxd]];

If[MemberQ[SEa,jxd]&&MemberQ[SEb,kxd],ja=jxd;kb=kxd];
If[MemberQ[SEa,kxd]&&MemberQ[SEb,jxd],ja=kxd;kb=jxd];

If[MemberQ[SEb,kxd]&&MemberQ[SEb,jxd],
(* bb displacements *)
jb=jxd;kb=kxd;
pjbpkbp=Flatten[Position[disp,ReplacePart[d0,{jb-> dsizej,kb-> dsizek}]]][[1]];
pjbmkbm=Flatten[Position[disp,ReplacePart[d0,{jb-> -dsizej,kb-> -dsizek}]]][[1]];
ja=SEa[[Flatten[Position[SEb,jb]][[1]]]];
ka=SEa[[Flatten[Position[SEb,kb]][[1]]]];
pjapkap=Flatten[Position[disp,ReplacePart[d0,{ja-> dsizej,ka-> dsizek}]]][[1]];
pjamkam=Flatten[Position[disp,ReplacePart[d0,{ja-> -dsizej,ka-> -dsizek}]]][[1]];
Edisp[[pjbpkbp]]=(Edisp[[pjapkap]]+Edisp[[pjamkam]])/2;
Edisp[[pjbmkbm]]=Edisp[[pjbpkbp]],

(* ab displacements *)

If[(MemberQ[degensets,{ja,kb}]||MemberQ[degensets,{kb,ja}])&& Abs[{dsizej,dsizek}]== {1,1},
pjap=Flatten[Position[disp,ReplacePart[d0,ja-> dsizej]]][[1]];
p2jap=Flatten[Position[disp,ReplacePart[d0,ja-> 2 dsizej]]][[1]];
pjam=Flatten[Position[disp,ReplacePart[d0,ja-> -dsizej]]][[1]];
p2jam=Flatten[Position[disp,ReplacePart[d0,ja-> -2 dsizej]]][[1]];
pjapkbp=Flatten[Position[disp,ReplacePart[d0,{ja-> dsizej,kb-> dsizek}]]][[1]];

Edisp[[pjapkbp]]=
(2 Edisp[[p2jap]]+4 Edisp[[pjap]]-3 e0+4 Edisp[[pjam]]-Edisp[[p2jam]])/6;
If[MemberQ[\[Theta]linsets,{ja,kb}]||MemberQ[\[Theta]linsets,{kb,ja}],
csym=1;
If[MemberQ[Flatten[\[Theta]sym],ja]&&MemberQ[Flatten[\[Theta]sym],kb],csym=2];
Edisp[[pjapkbp]]=Edisp[[pjapkbp]]-(2/csym) rr[[ja]]^2*
(Edisp[[p2jap]]-16 Edisp[[pjap]]+30 e0-16 Edisp[[pjam]]+Edisp[[p2jam]])/72],

jb=SEb[[Flatten[Position[SEa,ja]][[1]]]];
ka=SEa[[Flatten[Position[SEb,kb]][[1]]]];
pjapkbp=Flatten[Position[disp,ReplacePart[d0,{ja-> Abs[dsizej],kb-> Abs[dsizek]}]]][[1]];
pjapkap=Flatten[Position[disp,ReplacePart[d0,{ja-> Abs[dsizej],ka-> Abs[dsizek]}]]][[1]];
pjapkam=Flatten[Position[disp,ReplacePart[d0,{ja-> Abs[dsizej],ka->-Abs[dsizek]}]]][[1]];
pjamkap=Flatten[Position[disp,ReplacePart[d0,{ja-> -Abs[dsizej],ka-> Abs[dsizek]}]]][[1]];
pjamkam=Flatten[Position[disp,ReplacePart[d0,{ja-> -Abs[dsizej],ka-> -Abs[dsizek]}]]][[1]];
pjap=Flatten[Position[disp,ReplacePart[d0,ja-> Abs[dsizej]]]][[1]];
pjam=Flatten[Position[disp,ReplacePart[d0,ja-> -Abs[dsizej]]]][[1]];
pkap=Flatten[Position[disp,ReplacePart[d0,ka-> Abs[dsizek]]]][[1]];
pkam=Flatten[Position[disp,ReplacePart[d0,ka-> -Abs[dsizek]]]][[1]];

If[dsizej<0,
pjamkbp=Flatten[Position[disp,ReplacePart[d0,{ja-> -Abs[dsizej],kb-> Abs[dsizek]}]]][[1]];
pjamkbm=Flatten[Position[disp,ReplacePart[d0,{ja-> -Abs[dsizej],kb-> -Abs[dsizek]}]]][[1]];
Edisp[[pjamkbp]]=
(Edisp[[pjapkap]]+Edisp[[pjapkam]]-Edisp[[pjamkap]]-Edisp[[pjamkam]])/2+Edisp[[pjapkbp]]+
2(Edisp[[pjam]]-Edisp[[pjap]]);
Edisp[[pjamkbm]]=Edisp[[pjamkbp]]];

If[dsizej>0,
pkapjbp=Flatten[Position[disp,ReplacePart[d0,{jb-> Abs[dsizej],ka-> Abs[dsizek]}]]][[1]];
pjapkbm=Flatten[Position[disp,ReplacePart[d0,{ja-> Abs[dsizej],kb-> -Abs[dsizek]}]]][[1]];
Edisp[[pjapkbp]]=Edisp[[pkapjbp]]+
(Edisp[[pjamkap]]-Edisp[[pjapkam]])/2+(Edisp[[pjap]]+Edisp[[pkam]]-Edisp[[pjam]]-Edisp[[pkap]]);
Edisp[[pjapkbm]]=Edisp[[pjapkbp]]];

];
];
];

,
{k,Length[degendisplist]}]
]; 

Do[
Do[
If[Length[Union[findx[u][[v]]]]==u,

Do[s[i]=findx[u][[v,i]],{i,u}];w={}; tx={};
Do[pset=KSubsets[Table[s[k],{k,u}],p];
Do[
tx=Join[tx,{p}];
w=Join[w,
{1+Sum[Binomial[pset[[j,k]]-1,p-k+1],{k,p}]}],{j,Length[pset]}],{p,u}];

  px=Length[tx]; Yd=Table[0,{p,px},{q,Length[pd[tx[[p]],nderx]]}];

 Do[d3p=Table[{a[tx[[p]]][[w[[p]],k]]},{k,tx[[p]]}];d4p=pd[tx[[p]],nderx];
Do[
idisp=Flatten[d3p];
jdisp=Table[d1[[d4p[[q,j,1]]]],{j,Length[d4p[[q]]]}];
ijsort=Transpose[Sort[Table[{idisp[[k]],jdisp[[k]]},{k,Length[idisp]}]]];

idisp=ijsort[[1]];jdisp=ijsort[[2]];

idispL=Length[idisp];
jdisp=fdisp[jdisp];
If[idispL!=0,
jinteger=Sum[Binomial[idisp[[j]]-1,j],{j,idispL,1,-1}]*(2 ndx)^idispL+Dot[Table[(2 ndx)^(j-1),{j,idispL}],jdisp-1]+1+Sum[Binomial[n,j] (2 ndx)^j,{j,idispL-1}],jinteger=0];
pospqT=Flatten[Position[dispcode,jinteger]];
pospq=pospqT[[1]];
Yd[[p,q]]=Edisp[[pospq]],{q,Length[pd[tx[[p]],nderx]]}],{p,px}];

 Do[Do[cp=c[t,u][[m]];
If[favg,nf=Length[nv[[nderx,u,t,m,1]]],nf=1];
zf=Table[0,{jf,nf}];sdig=epres;
Do[

Ydc=Table[nv[[nderx,u,t,m,p]][[jf]],{p,px}];
wfv=Flatten[Table[Yd[[p,q]] Ydc[[p,q]],{p,Length[Yd]},{q,Length[Yd[[p]]]}]];
If[Length[Complement[Coefficient[wfv,nc],{0}]]==  0,
wf=(Tr[wfv]+n0[[nderx,u,t,m]][[jf]] e0)*conv,wf=nc];

If[Coefficient[wf,sx]!=0 ||Coefficient[wf,nc]!=0 || formula== True,xpres=epres,xpres=Max[epres+MantissaExponent[wf][[2]],0],xpres=epres];
sdig=Min[sdig,xpres];
zf[[jf]]=wf/Product[rr[[s[i]]]^cp[[i]],{i,u}],{jf,nf}];

zf=Sort[zf];
z=Tr[zf]/nf;dz=0;If[nf>1,dz=zf[[nf]]-zf[[1]],dz=sdig];
cx=Flatten[Table[Table[s[i],{q,cp[[i]]}],{i,u}]];
j=Flatten[Position[findx[t],cx]][[1]];
f[t]=ReplacePart[f[t],z,j];
df[t]=ReplacePart[df[t],dz,j],{m,Length[c[t,u]]}],{t,u,nderx}]],{v,Length[findx[u]]}],{u,tderx}];

If[showprogress== True,totaltime=TimeUsed[]-tstart;Print["Progress = ",Floor[100 N[iq/nqx]]," %, CPU = ",totaltime]];

If[dispder>0 ,Do[Do[j=Flatten[Position[findx[t+dispder],Sort[Join[Table[r0[k],{k,dispder}],findx[t][[mq]]],Greater]]][[1]];
xx=f[t][[mq]];xy=g[t+dispder][[j]];
xy=Join[xy,{xx}];
g[t+dispder]=ReplacePart[g[t+dispder],xy,j],{mq,Length[findx[t]]}],{t,nderx}]],{iq,nqx}];

If[dispder>0,
f[dispder]=Part[Transpose[Edisp2],Part[Position[disp2,Table[0,{nk,n}]],1,1]];
Do[Do[xx=Part[g[t+dispder],mq];xx=Sort[Complement[xx,{nc}]];nf=Length[xx];
If[nf!=0,xz=Tr[xx]/nf;xw=xx[[nf]]-xx[[1]],xz=nc;xw=nc];
f[t+dispder]=ReplacePart[f[t+dispder],xz,mq];
df[t+dispder]=ReplacePart[df[t+dispder],xw,mq],{mq,Length[g[t+dispder]]}],{t,nderx}]];

Do[If[Coefficient[f[nder][[ksx]],sx]!=0,f[nder]=ReplacePart[f[nder],0,ksx];df[nder]=ReplacePart[df[nder],Inf,ksx]],{ksx,Length[f[nder]]}];

fres=Table[{Chop[f[k],10^(-ichop[[k]])],df[k]},{k,nder}];

Do[
Do[jdx=Part[findx[kder],j];vanish=False;
Do[If[OddQ[Sum[Count[symtot[[k]],jdx[[ix]]],{ix,Length[jdx]}]],vanish=True],{k,Length[symtot]}];
If[vanish,fres[[kder,1,j]]=0;fres[[kder,2,j]]=sx],{j,Length[fres[[kder,1]]]}],{kder,nder}]];




If[job=="findmin" && nder>= 2,
nx=n;
xvar=Table[ToExpression[StringJoin["w",ToString[k]]],{k,n}];
Do[If[re[[k]]==0,xvar[[k]]=0],{k,n}];
f1x=Take[fres[[1,1]],nx];h1=f1x;
Vpot=Dot[h1,xvar];
f2x=Take[fres[[2,1]],nx (nx+1)/2]; 
h2=Table[0,{i,nx},{j,nx}];q=0;
Do[q=q+1;h2[[i,j]]=f2x[[q]]; h2[[j,i]]=h2[[i,j]],{i,nx},{j,i}];
Vpot=Vpot+(1/2)Expand[Dot[Dot[h2,xvar],xvar]];
f5=Table[0,{k,nx}];
If[nder>=3,
f3x=Take[fres[[3,1]],nx (nx+1) (nx+2)/6]; 
h3=Table[0,{i,nx},{j,nx},{k,nx}];q=0;
Do[q=q+1;h3[[i,j,k]]=f3x[[q]]; h3[[i,k,j]]=h3[[i,j,k]];
h3[[j,i,k]]=h3[[i,j,k]];h3[[k,i,j]]=h3[[i,j,k]];
h3[[j,k,i]]=h3[[i,j,k]];h3[[k,j,i]]=h3[[i,j,k]],{i,nx},{j,i},{k,j}];
Vpot=Vpot+(1/6)Expand[Dot[Dot[Dot[h3,xvar],xvar],xvar]]];
If[nder>=4,
f4x=Take[fres[[4,1]],nx (nx+1) (nx+2) (nx+3)/24];
h4=Table[0,{i,nx},{j,nx},{k,nx},{l,nx}];q=0;
Do[q=q+1;h4[[i,j,k,l]]=f4x[[q]]; h4[[i,j,l,k]]=h4[[i,j,k,l]];
h4[[i,k,j,l]]=h4[[i,j,k,l]];h4[[i,k,l,j]]=h4[[i,j,k,l]];
h4[[i,l,j,k]]=h4[[i,j,k,l]];h4[[i,l,k,j]]=h4[[i,j,k,l]];
h4[[j,i,k,l]]=h4[[i,j,k,l]];h4[[j,i,l,k]]=h4[[i,j,k,l]];
h4[[j,k,i,l]]=h4[[i,j,k,l]];h4[[j,k,l,i]]=h4[[i,j,k,l]];
h4[[j,l,i,k]]=h4[[i,j,k,l]];h4[[j,l,k,i]]=h4[[i,j,k,l]];
h4[[k,i,j,l]]=h4[[i,j,k,l]];h4[[k,i,l,j]]=h4[[i,j,k,l]];
h4[[k,j,i,l]]=h4[[i,j,k,l]];h4[[k,j,l,i]]=h4[[i,j,k,l]];
h4[[k,l,i,j]]=h4[[i,j,k,l]];h4[[k,l,j,i]]=h4[[i,j,k,l]];
h4[[l,i,j,k]]=h4[[i,j,k,l]];h4[[l,i,k,j]]=h4[[i,j,k,l]];
h4[[l,j,i,k]]=h4[[i,j,k,l]];h4[[l,j,k,i]]=h4[[i,j,k,l]];
h4[[l,k,i,j]]=h4[[i,j,k,l]];h4[[l,k,j,i]]=h4[[i,j,k,l]],{i,nx},{j,i},{k,j},{l,k}];
Vpot=Vpot+(1/24)Expand[Dot[Dot[Dot[Dot[h4,xvar],xvar],xvar],xvar]];
If[estquintic,
Do[k=kstr[[j]]; f5[[k]]=(h4[[k,k,k,k]])^2/h3[[k,k,k]],{j,Length[kstr]}];
Vpot=Vpot+Dot[f5,xvar^5]/120]];
xopt=Complement[xvar,{0}];
xmin=FindMinimum@@Join[{Vpot},Table[{xopt[[k]],0},{k,Length[xopt]}],{AccuracyGoal->10},{PrecisionGoal->10}];
dxanh=Evaluate[xvar]/.xmin[[2]];
dxharm=-Dot[Inverse[h2],h1];
dx=dxanh;
rmin=re+dx;
Vchange=Evaluate[Vpot]/.Table[xvar[[k]]-> dx[[k]],{k,n}];
h2x=Evaluate[h2+Expand[Dot[h3,xvar]+(1/2) Dot[Dot[h4,xvar],xvar]]]/.
Table[xvar[[k]]-> dx[[k]],{k,n}];
If[estquintic,Do[h2x[[k,k]]=h2x[[k,k]]+f5[[k]]* (dx[[k]])^3/6,{k,n}]];
h2x=Chop[h2x,10^-3];q=0;
Do[q=q+1;f2x[[q]]=h2x[[i,j]],{i,nx},{j,i}];
fres2={{Table[0,{k,n}]},{f2x}};
If[nder>= 3,h3x=Evaluate[h3+Expand[Dot[h4,xvar]]]/.Table[xvar[[k]]-> dx[[k]],{k,n}];
If[estquintic,Do[h3x[[k,k,k]]=h3x[[k,k,k]]+f5[[k]]* (dx[[k]])^2/2,{k,n}]];
q=0;
Do[q=q+1;f3x[[q]]=h3x[[i,j,k]],{i,nx},{j,i},{k,j}];
fres2=Join[fres2,{{f3x}}]];
If[nder>= 4,h4x=h4;
If[estquintic,Do[h4x[[k,k,k,k]]=h4x[[k,k,k,k]]+f5[[k]]*dx[[k]],{k,n}]];
q=0;
Do[q=q+1;f4x[[q]]=h4x[[i,j,k,l]],{i,nx},{j,i},{k,j},{l,k}];
fres2=Join[fres2,{{f4x}}]];
findminout={};
findminout=Join[findminout,{"Anharmonic min step ",dxanh}];
findminout=Join[findminout,{"Harmonic min step ",dxharm}];
findminout=Join[findminout,{"Energy change ",Vchange}];
findminout=Join[findminout,{"Re values (rmin) ",rmin}];
findminout=Join[findminout,{"Quadratic force constants at new minimum (h2x) ",TableForm[h2x]}];
If[(Length[Flatten[CART@@rmin]]-Length[CART@@rmin])>0,xopt=Chop[(CART@@rmin),10^-10];
findminout=Join[findminout,{"Cartesian optimum geometry (xopt)",TableForm[xopt]}]]];



If[job=="freq",natoms=Length[mass];nCart=3 natoms;
umat=Table[0,{i,nCart},{j,nCart}];
Do[umat[[3 k-3+j,3 k-3+j]]=1/mass[[k]],{k,Length[mass]},{j,3}];
xpoint=Flatten[xref];
Bmat=Transpose[Table[Evaluate[D[INTC@@Table[x[j],{j,nCart}],{x[i],1}]]/.Table[x[j]-> xpoint[[j]],{j,nCart}],{i,nCart}]];
Gmat=Dot[Dot[Bmat,umat],Transpose[Bmat]];
h2=Table[0,{i,n},{j,n}];q=0;
Do[q=q+1;h2[[i,j]]=fc2[[q]]; h2[[j,i]]=h2[[i,j]],{i,n},{j,i}];
egn=Eigensystem[Dot[Gmat,h2]];
freqs=wave Sqrt[egn[[1]]];
Lvib=Transpose[egn[[2]]]];



If[job== "degen",
ndtotal=Max[Table[Max[degensets[[k]]],{k,Length[degensets]}]];
degenlist=Sort[Flatten[degensets]];
dlistnon=Complement[Range[ndtotal],degenlist];

dseta={};dsetb={};
Do[If[Length[degensets[[k]]]==2,dseta=Join[dseta,{degensets[[k,1]]}];dsetb=Join[dsetb,{degensets[[k,2]]}]],{k,Length[degensets]}];

(* Make index finding arrays *)
findx[0]={{1}};
Do[findx[t]=Flatten[Apply[Table,Join[{Table[s0[j],{j,t}],{s0[1],ndtotal}},Table[{s0[i],s0[i-1]},{i,2,t}]]],t-1],{t,nder}];

(* Allocate additional space in force constant arrays if needed *)
Do[fres[[t,1]]=Join[fres[[t,1]],Flatten[Apply[Table,Join[{0,{s0[1],n+1,ndtotal}},Table[{s0[i],s0[i-1]},{i,2,t}]]],t-1]];
fres[[t,2]]=Join[fres[[t,2]],Flatten[Apply[Table,Join[{sx,{s0[1],n+1,ndtotal}},Table[{s0[i],s0[i-1]},{i,2,t}]]],t-1]],{t,nder}];

(* Zero out force field elements that are zero by symmetry *)
offblock={};
Do[
Do[
klist=Part[findx[t],k];
nonk=Intersection[klist,dlistnon];
offtest1=Length[klist]-Sum[Count[klist,nonk[[j]]],{j,Length[nonk]}]== 1;
bk=Intersection[klist,dsetb];
offtest2=OddQ[Sum[Count[klist,bk[[j]]],{j,Length[bk]}]];
If[offtest1 || offtest2,offblock=Join[offblock,{klist}];fres[[t,1,k]]=0;
fres[[t,2,k]]=sx],{k,Length[findx[t]]}],{t,nder}];

symblock={};sumblock={};
If[nder>= 2,
degaa=Flatten[Table[Sort[{dseta[[s0[1]]],dseta[[s0[2]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]}],1];
degbb=Flatten[Table[Sort[{dsetb[[s0[1]]],dsetb[[s0[2]]]},Greater],{s0[1],Length[dsetb]},{s0[2],s0[1]}],1];
deg2=Transpose[{degaa,degbb}];
symblock=Join[symblock,Table[Join[deg2[[j]],{{1,1}}],{j,Length[deg2]}]]];

If[nder>= 3,
degaaa=Flatten[Table[Sort[{dseta[[s0[1]]],dseta[[s0[2]]],dseta[[s0[3]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]}],2];
degabb=Flatten[Table[Sort[{dseta[[s0[1]]],dsetb[[s0[2]]],dsetb[[s0[3]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]}],2];
degbab=Flatten[Table[Sort[{dsetb[[s0[1]]],dseta[[s0[2]]],dsetb[[s0[3]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]}],2];
degbba=Flatten[Table[Sort[{dsetb[[s0[1]]],dsetb[[s0[2]]],dseta[[s0[3]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]}],2];
deg3=Table[Join[{degaaa[[k]]},Union[{degabb[[k]],degbab[[k]],degbba[[k]]}]],{k,Length[degaaa]}];
non1=Table[{dlistnon[[s0[1]]]},{s0[1],Length[dlistnon]}];
symblock=Join[symblock,Flatten[Table[{Sort[Join[deg2[[j,1]],non1[[k]]],Greater],Sort[Join[deg2[[j,2]],non1[[k]]],Greater],{1,1}},{j,Length[deg2]},{k,Length[non1]}],1]];
symblock=Join[symblock,Table[Join[deg3[[k]],{Join[{1},Table[-1,{j,Length[deg3[[k]]]-1}]]}],{k,Length[deg3]}]]];

If[nder>= 4,
non2=Flatten[Table[Sort[{dlistnon[[s0[1]]],dlistnon[[s0[2]]]},Greater],{s0[1],Length[dlistnon]},{s0[2],s0[1]}],1];
symblock=Join[symblock,Flatten[Table[{Sort[Join[deg2[[j,1]],non2[[k]]],Greater],Sort[Join[deg2[[j,2]],non2[[k]]],Greater],{1,1}},{j,Length[deg2]},{k,Length[non2]}],1]];
symblock=Join[symblock,Flatten[Table[Join[Table[Sort[Join[deg3[[j,q1]],non1[[k]]],Greater],{q1,Length[deg3[[j]]]}],{Join[{1},Table[-1,{q2,Length[deg3[[j]]]-1}]]}],{j,Length[deg3]},{k,Length[non1]}],1]] ;

degaaaa=Flatten[Table[Sort[{dseta[[s0[1]]],dseta[[s0[2]]],dseta[[s0[3]]],dseta[[s0[4]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]},{s0[4],s0[3]}],3];
degbbbb=Flatten[Table[Sort[{dsetb[[s0[1]]],dsetb[[s0[2]]],dsetb[[s0[3]]],dsetb[[s0[4]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]},{s0[4],s0[3]}],3];
degaabb=Flatten[Table[Sort[{dseta[[s0[1]]],dseta[[s0[2]]],dsetb[[s0[3]]],dsetb[[s0[4]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]},{s0[4],s0[3]}],3];
degbbaa=Flatten[Table[Sort[{dsetb[[s0[1]]],dsetb[[s0[2]]],dseta[[s0[3]]],dseta[[s0[4]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]},{s0[4],s0[3]}],3];
degabab=Flatten[Table[Sort[{dseta[[s0[1]]],dsetb[[s0[2]]],dseta[[s0[3]]],dsetb[[s0[4]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]},{s0[4],s0[3]}],3];
degbaba=Flatten[Table[Sort[{dsetb[[s0[1]]],dseta[[s0[2]]],dsetb[[s0[3]]],dseta[[s0[4]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]},{s0[4],s0[3]}],3];
degabba=Flatten[Table[Sort[{dseta[[s0[1]]],dsetb[[s0[2]]],dsetb[[s0[3]]],dseta[[s0[4]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]},{s0[4],s0[3]}],3];
degbaab=Flatten[Table[Sort[{dsetb[[s0[1]]],dseta[[s0[2]]],dseta[[s0[3]]],dsetb[[s0[4]]]},Greater],{s0[1],Length[dseta]},{s0[2],s0[1]},{s0[3],s0[2]},{s0[4],s0[3]}],3];
deg4=Table[{degaaaa[[k]],degbbbb[[k]],{1,1}},{k,Length[degaaaa]}];
Do[If[degaabb[[k]]!= degbbaa[[k]],deg4=Join[deg4,{{degaabb[[k]],degbbaa[[k]],{1,1}}}]];
If[degabab[[k]]!= degbaba[[k]],deg4=Join[deg4,{{degabab[[k]],degbaba[[k]],{1,1}}}]];
If[degabba[[k]]!= degbaab[[k]],deg4=Join[deg4,{{degabba[[k]],degbaab[[k]],{1,1}}}]],{k,Length[degaaaa]}];
symblock=Join[symblock,Union[Table[Join[Sort[Drop[deg4[[k]],-1]],{deg4[[k,-1]]}],{k,Length[deg4]}]]];

degabba2=Flatten[Table[Sort[{dseta[[s0[1]]],dsetb[[s0[1]]],dsetb[[s0[1]]],dseta[[s0[2]]]},Greater],{s0[1],Length[dseta]},{s0[2],Length[dseta]}],1];
degbaab2=Flatten[Table[Sort[{dsetb[[s0[1]]],dseta[[s0[1]]],dseta[[s0[1]]],dsetb[[s0[2]]]},Greater],{s0[1],Length[dseta]},{s0[2],Length[dseta]}],1];
degaaaa2=Flatten[Table[Sort[{dseta[[s0[1]]],dseta[[s0[1]]],dseta[[s0[1]]],dseta[[s0[2]]]},Greater],{s0[1],Length[dseta]},{s0[2],Length[dseta]}],1];
symblockloc=Table[Drop[symblock[[k]],-1],{k,Length[symblock]}];

kdrop={};
Do[kpos=Flatten[Position[symblock,degaaaa2[[k]]]][[1]];
symbx=symblock[[kpos]];
symbxadd=Union[{degabba2[[k]],degbaab2[[k]]}];
cbxadd=Table[3,{j,Length[symbxadd]}];
kloc=Flatten[Position[symblockloc,symbxadd]];
If[Length[kloc]>0,kdrop=Join[kdrop,kloc]];
symblock[[kpos]]=Join[Join[Drop[symbx,-1],symbxadd],{Join[symbx[[-1]],cbxadd]}],{k,Length[degaaaa2]}];
kdrop=Sort[kdrop,Greater];

(* Do[symblock=Drop[symblock,{kdrop[[k]]}],{k,Length[kdrop]}];*)

deg4sum={};
Do[sumset0={degabba[[k]],degabab[[k]],degaabb[[k]],degbaab[[k]],degbaba[[k]],degbbaa[[k]]};
sumset1=Union[sumset0];
sumcoef=Table[Count[sumset0,sumset1[[q1]]],{q1,Length[sumset1]}];
deg4sum=Join[deg4sum,{Join[{degaaaa[[k]],degbbbb[[k]]},sumset1,{Join[{-1,-1},sumcoef]}]}],{k,Length[degaaaa]}];
 sumblock=Join[sumblock,deg4sum]  ] ;

kdrop={};
symblockloc=Table[Drop[symblock[[k]],-1],{k,Length[symblock]}];
Do[If[Length[Position[symblockloc,Drop[sumblock[[k]],-1]]]>0,kdrop=Join[kdrop,{k}]],{k,Length[sumblock]}];
kdrop=Sort[kdrop,Greater];
Do[sumblock=Drop[sumblock,{kdrop[[k]]}],{k,Length[kdrop]}];

sumblock=Union[sumblock];

If[linearmol && (Length[\[Theta]lin]> 0),
\[Theta]sym=Table[Sort[\[Theta]sym[[k]]],{k,Length[\[Theta]sym]}];
lindegsum={};

Do[
If[(Length[symblock[[k,1]]]== 4) && (Length[Complement[symblock[[k,1]],Intersection[symblock[[k,1]],Flatten[\[Theta]linsets]]]]== 0) &&
(Count[symblock[[k,1]],symblock[[k,1,1]]]!= 2),
f4gen=Union[symblock[[k,1]]];

If[(Length[f4gen]== 1),kagen=f4gen[[1]];
kbgen=degensets[[Flatten[Position[degensets,kagen]][[1]],2]];
If[(Union[symblock[[k,2]]]=={kbgen})&&(Sort[Union[symblock[[k,3]]]]==Sort[{kagen,kbgen}]),
If[Length[Intersection[Flatten[\[Theta]sym],{kagen}]]!= 0,degcoeff=2,degcoeff=4];
lindegsum=Join[lindegsum,{{symblock[[k,1]],{kagen,kagen},symblock[[k,3]],{-1,-degcoeff,3}}}];
symblock[[k]]={symblock[[k,1]],symblock[[k,2]],{1,1}}]
];
If[(Length[f4gen]== 2),kagen=f4gen[[1]];jagen=f4gen[[2]];
kbgen=degensets[[Flatten[Position[degensets,kagen]][[1]],2]];
jbgen=degensets[[Flatten[Position[degensets,jagen]][[1]],2]];
If[(Sort[Union[symblock[[k,2]],symblock[[k,3]],symblock[[k,4]]]]==Sort[{kagen,kbgen,jagen,jbgen}]),
degcoeff=2^(Length[Intersection[Flatten[\[Theta]sym],{kagen,jagen}]]/2);
lindegsum=Join[lindegsum,{{symblock[[k,1]],Sort[{kagen,jagen},Greater],symblock[[k,3]],{-degcoeff,-1,3 degcoeff}}}];
lindegsum=Join[lindegsum,{{symblock[[k,1]],Sort[{kagen,jagen},Greater],symblock[[k,4]],{-degcoeff,-1,3 degcoeff}}}];
symblock[[k]]={symblock[[k,1]],symblock[[k,2]],{1,1}}
]]],{k,Length[symblock]}];

Do[
If[(Count[Table[Length[sumblock[[k,j]]],{j,Length[sumblock[[k]]]-1}],4]==Length[sumblock[[k]]]-1)&&
(Length[Complement[Union[Flatten[Drop[sumblock[[k]],-1]]],Flatten[\[Theta]linsets]]]== 0),
If[(Length[Flatten[Position[Transpose[Tally[sumblock[[k,1]]]][[2]],2]]]== 1),
kagen=sumblock[[k,1,Flatten[Position[Transpose[Tally[sumblock[[k,1]]]][[2]],2]][[1]]]];{jagen,iagen}=Complement[sumblock[[k,1]],{kagen}];

If[(Length[Position[\[Theta]sym,Sort[{kagen,jagen}]]]!= 0)||(Length[Position[\[Theta]sym,Sort[{kagen,iagen}]]]!= 0),
newsum=Join[{sumblock[[k,1]]},{Sort[{iagen,jagen},Greater]},Drop[sumblock[[k]],1]];
newsum=ReplacePart[newsum,-1-> Join[{sumblock[[k,-1,1]]},{-1},Drop[sumblock[[k,-1]],1]]];
];
sumblock[[k]]=newsum;
];
If[(Length[Flatten[Position[Transpose[Tally[sumblock[[k,1]]]][[2]],2]]]== 2),{jagen,kagen}=Union[sumblock[[k,1]]];If[(Length[Position[\[Theta]sym,Sort[{kagen,jagen}]]]!= 0),
newsum=Join[{sumblock[[k,1]]},{{kagen,kagen},{jagen,jagen}},Drop[sumblock[[k]],1]];
newsum=ReplacePart[newsum,-1-> Join[{sumblock[[k,-1,1]]},{-2,-2},Drop[sumblock[[k,-1]],1]]];
sumblock[[k]]=newsum;
]]],
{k,Length[sumblock]}];

 sumblock=Union[lindegsum,sumblock]];

If[nder>= 5,Print["INTDIF is currently able to symmetrize force fields of linear and symmetric tops through 4th order"]];

(* Perform symmetry averaging *)
SymReport={};kdrop={};nunk=0;
Do[t=Length[symblock[[k,1]]];
symcoef=symblock[[k,-1]];
poslist=Flatten[Table[Position[findx[t],symblock[[k,j]]],{j,Length[symblock[[k]]]-1}]];
fval=Table[fres[[t,1,poslist[[j]]]],{j,Length[poslist]}];

fval=Evaluate[fval]/. {0. nc -> 0};
fvalvar=fval;
valrange=Table[0,{j,Length[fval]}];

If[Length[Complement[Coefficient[fval,nc],{0}]]== Length[fval],nunk=nunk+1];
Do[If[Coefficient[fval[[j]],nc]!= 0,fval[[j]]=0; fvalvar[[j]]=symcoef[[j]] fvar[nunk]],{j,Length[fval]}];

If[Length[fval] > Count[fval,0],
nfavg=Length[fval]-Count[fval,0];
fvalavg=Dot[fval,symcoef]/nfavg;
valrange=Max[fval*symcoef]-Min[fval*symcoef];
fvalfill=Table[fvalavg/symcoef[[j]],{j,Length[fval]}];
SymReport=Join[SymReport,{Join[{"eq"},symblock[[k]],{fval*symcoef},{valrange}]}],
fvalfill=fvalvar;
kdrop=Join[kdrop,{k}]];

Do[fres[[t,1,poslist[[j]]]]=fvalfill[[j]],{j,Length[poslist]}];
Do[fres[[t,2,poslist[[j]]]]=valrange/symcoef[[j]],{j,Length[poslist]}],{k,Length[symblock]}];
kdrop=Sort[kdrop,Greater];

(* Do[symblock=Drop[symblock,{kdrop[[k]]}],{k,Length[kdrop]}];*)

kdrop={};
subvars=Table[fvar[j]-> nc,{j,nunk}];
Do[
poslist=Flatten[Table[Position[findx[Length[sumblock[[k,j]]]],sumblock[[k,j]]],{j,Length[sumblock[[k]]]-1}]];
fval=Table[fres[[Length[sumblock[[k,j]]],1,poslist[[j]]]],{j,Length[poslist]}];
sumcoef=sumblock[[k,-1]];
fcorrection=Table[0,{j,Length[fval]}];
fvalnc=Coefficient[Evaluate[fval]/.subvars,nc];
numnc=Length[fval]-Count[fvalnc,0];

If[numnc== 0,
kuncorr=Count[Table[Length[sumblock[[k,j]]],{j,Length[sumblock[[k]]]-1}],2]+2;
If[kuncorr==Length[fval],kuncorr=kuncorr-1];
fvaldev=Dot[fval,sumcoef]/(Length[fval]-kuncorr);
fcorrection=Join[Table[0,{j,kuncorr}],Table[-fvaldev/sumcoef[[j]],{j,kuncorr+1,Length[fval]}]];
If[Mean[Abs[fcorrection]]> sumcut,
Do[fres[[Length[sumblock[[k,j]]],1,poslist[[j]]]]=fval[[j]]+fcorrection[[j]],{j,3,Length[poslist]}];
Do[fres[[Length[sumblock[[k,j]]],2,poslist[[j]]]]=fcorrection[[j]],{j,kuncorr+1,Length[poslist]}]  ]];

If[numnc== 1,
posnc=Complement[Range[Length[fval]],Flatten[Position[fvalnc,0]]][[1]];
valnc=-Dot[Drop[fval,{posnc}],Drop[sumcoef,{posnc}]]/sumcoef[[posnc]];
fres[[Length[sumblock[[k,posnc]]],1,poslist[[posnc]]]]=valnc;
fval=ReplacePart[fval,posnc-> 0];
fcorrection=ReplacePart[fcorrection,posnc-> valnc]];

numnc=Length[fval]-Count[Coefficient[fval,nc],0];
fvarset=Intersection[fval,Table[fvar[j],{j,nunk}]];

If[(numnc== 0)&&(Length[fvarset]== 1),
fvalsol=Evaluate[fval]/.Flatten[Solve[Dot[fval,sumcoef]== 0,fvarset[[1]]]];
fcorrection=fvalsol-fval;
Do[fres[[Length[sumblock[[k,j]]],1,poslist[[j]]]]=fvalsol[[j]],{j,Length[poslist]}]];

If[Count[fval,0]!= Length[fval],
SymReport=Join[SymReport,{Join[{"sum"},sumblock[[k]],{fval},{fcorrection}]}]],
{k,Length[sumblock]}];

Clear[F];
If[PrintSym,Do[nq=Length[SymReport[[j]]]-4;
coef=SymReport[[j,nq+2]];
felements=Table[Apply[F,SymReport[[j,q+1]]],{q,nq}];
fval=SymReport[[j,nq+3]];
If[SymReport[[j,1]]== "eq",
frange=SymReport[[j,nq+4]];
EqRules = Join[EqRules,{felements*coef}];
Apply[Print,{"Equivalences: ",felements*coef," Values = ",fval," Range = ",frange}]];
If[SymReport[[j,1]]== "sum",
sumrule=ToString[felements[[1]]*coef[[1]]];
Do[If[coef[[k]]<0,sumrule=StringJoin[sumrule," ",ToString[felements[[k]]*coef[[k]]]],
sumrule=StringJoin[sumrule," + ",ToString[felements[[k]]*coef[[k]]]]],{k,2,nq}];
sumrule=StringJoin[sumrule," = 0"];
SumRules = Join[SumRules,{sumrule}];
frange=Join[SymReport[[j,nq+4]]];
Apply[Print,{"Applied Sum Rule: ",sumrule,", Values = ",fval," Applied shift = ",frange}]],{j,Length[SymReport]}]] ];
